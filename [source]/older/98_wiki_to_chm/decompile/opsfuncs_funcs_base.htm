<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
   <title>Базовые функции языка QSP</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=Windows-1251" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />

<script type="text/javascript" src="helpman_topicinit.js"></script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#808080">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Базовые функции языка QSP</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="about.htm">Top</a>&nbsp;
     <a href="opsfuncs_funcs.htm">Previous</a>&nbsp;
     <a href="opsfuncs_funcs_acts.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<div><a name="func_curloc"></a><span style="font-weight: bold;">CURLOC</span> - возвращает название текущей <a href="dict.htm#location">локации</a>.</div>
<p>&nbsp;</p>
<div><a name="func_rand"></a><span style="font-weight: bold;">RAND(</span>[#выражение 1]<span style="font-weight: bold;">,</span>[#выражение 2]<span style="font-weight: bold;">)</span> - возвращает случайное число между числами [#выражение 1] и [#выражение 2]. Параметр [#выражение 2] может отсутствовать, при этом он принимается равным 0.</div>
<p>&nbsp;</p>
<div><a name="func_rnd"></a><span style="font-weight: bold;">RND</span> - возвращает случайное значение от 1 до 1000.</div>
<p>&nbsp;</p>
<div><a name="func_input"></a><span style="font-weight: bold;">INPUT(</span>[$выражение]<span style="font-weight: bold;">)</span> - выводит окно ввода с приглашением [$выражение]. Возвращает введённый играющим текст, либо '' (пустая строка), если была нажата кнопка &quot;Отмена&quot;.</div>
<p>&nbsp;</p>
<div><a name="func_usertext"></a><span style="font-weight: bold;">USER_TEXT</span> и <span style="font-weight: bold;">USRTXT</span> - возвращают текст, находящийся в строке ввода.</div>
<p>&nbsp;</p>
<div><a name="func_max"></a><span style="font-weight: bold;">MAX(</span>[выражение 1]<span style="font-weight: bold;">,</span>[выражение 2]<span style="font-weight: bold;">,</span> ...<span style="font-weight: bold;">)</span> - возвращает максимальное из значений выражений-аргументов. Если передан один аргумент, то считается, что указано имя массива - в этом случае поиск максимального элемента происходит среди строковых (если название массива указано со знаком &quot;<span style="font-weight: bold;">$</span>&quot;) или среди числовых значений элементов массива. Например:</div>
<p>&nbsp;</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;MAX(1,2,5,2,0) - вернёт 5</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;MAX(a,b,c) - вернёт максимальное из значений переменных</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;MAX('aa','ab','zz') - вернёт 'zz'</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;MAX('a') - вернёт максимальное из числовых значений элементов массива &quot;A&quot;</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;MAX('$b') - вернёт максимальное из строковых значений элементов массива &quot;B&quot;</p>
<p>&nbsp;</p>
<p><a name="func_min"></a><span style="font-weight: bold;">MIN(</span>[выражение 1]<span style="font-weight: bold;">,</span>[выражение 2]<span style="font-weight: bold;">,</span> ...<span style="font-weight: bold;">)</span> - возвращает минимальное из значений выражений-аргументов. Если передан один аргумент, то считается, что указано имя массива - в этом случае поиск минимального элемента происходит среди строковых (если название массива указано со знаком &quot;<span style="font-weight: bold;">$</span>&quot;) или среди числовых значений элементов массива.</p>
<p>&nbsp;</p>
<div><a name="func_iif"></a><span style="font-weight: bold;">IIF(</span>[#выражение]<span style="font-weight: bold;">,</span>[выражение_да]<span style="font-weight: bold;">,</span>[выражение_нет]<span style="font-weight: bold;">)</span> - возвращает значение выражения [выражение_да], если [#выражение] верно, иначе значение выражения [выражение_нет].</div>
<p>&nbsp;</p>
<div><a name="func_rgb"></a><span style="font-weight: bold;">RGB(</span>[#выражение 1]<span style="font-weight: bold;">,</span>[#выражение 2]<span style="font-weight: bold;">,</span>[#выражение 3]<span style="font-weight: bold;">)</span> - возвращает код цвета на основе 3-х числовых аргументов. [#выражение 1], [#выражение 2] и [#выражение 3] определяют соответственно уровни красного, зелёного и синего цветов. Все значения аргументов должны быть в отрезке [0, 255]. Данная функция используется совместно с <a href="dict.htm#sys_variables">системными переменными</a> &quot;BCOLOR, FCOLOR, LCOLOR&quot;.</div>
<p>&nbsp;</p>
<div><a name="func_isplay"></a><span style="font-weight: bold;">ISPLAY(</span>[$выражение]<span style="font-weight: bold;">)</span> - проверяет, проигрывается ли файл с заданным названием в текущий момент времени и возвращает -1, если файл воспроизводится, иначе 0.</div>
<p>&nbsp;</p>
<div><a name="func_msecscount"></a><span style="font-weight: bold;">MSECSCOUNT</span> - возвращает количество миллисекунд, прошедших с момента начала игры.</div>
<p>&nbsp;</p>
<div><a name="func_desc"></a><span style="font-weight: bold;">DESC(</span>[$выражение]<span style="font-weight: bold;">)</span> - возвращает текст базового описания <a href="dict.htm#location">локации</a> с заданным в [$выражение] названием.</div>
<p>&nbsp;</p>
<div><a name="func_maintxt"></a><span style="font-weight: bold;">MAINTXT</span> - возвращает текст, находящийся в основном окне описаний.</div>
<p>&nbsp;</p>
<div><a name="func_stattxt"></a><span style="font-weight: bold;">STATTXT</span> - возвращает текст, находящийся в окне пользователя.</div>
<p>&nbsp;</p>
<div><a name="func_qspver"></a><span style="font-weight: bold;">QSPVER</span> - возвращает версию <a href="dict.htm#interpreter">интерпретатора</a> в формате &quot;X.Y.Z&quot;.</div>
<p>&nbsp;</p>
<p><a name="func_func"></a><span style="font-weight: bold;">FUNC(</span>[$выражение]<span style="font-weight: bold;">,</span>[параметр 1]<span style="font-weight: bold;">,</span>[параметр 2]<span style="font-weight: bold;">,</span> ...<span style="font-weight: bold;">)</span> - обработка <a href="dict.htm#sys_location">локации</a> с названием [$выражение]. Указанные параметры передаются в <a href="dict.htm#array">массиве</a> <span style="font-weight: bold;">ARGS</span>. Результат функции равен значению <span style="font-weight: bold;">$RESULT</span> при возврате строкового значения или <span style="font-weight: bold;">RESULT</span> при возврате числового значения. Если при обработке локации были установлены и RESULT, и $RESULT, то предпочтение отдаётся строковому значению. После обработки локации предыдущие значения ARGS и RESULT восстанавливаются. Примеры:</p>
<p>&nbsp;</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;PL 4 + FUNC('функция') - обработка локации &quot;функция&quot; как функции. Массив ARGS пуст. Результат передается через $RESULT или RESULT, в зависимости от кода обрабатываемой локации.</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;PL FUNC($name, 1) * 78 - обработка локации с названием в $name как функции. ARGS[0] равен 1.</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;MSG &quot;text&quot; + FUNC($name, &quot;строка&quot;, 2) - обработка локации с названием в $name как функции. $ARGS[0] содержит строку &quot;строка&quot;, ARGS[1] равен 2.</p>
<p>&nbsp;</p>
<div><a name="func_dyneval"></a><span style="font-weight: bold;">DYNEVAL(</span>[$выражение]<span style="font-weight: bold;">,</span>[параметр 1]<span style="font-weight: bold;">,</span>[параметр 2]<span style="font-weight: bold;">,</span> ...<span style="font-weight: bold;">)</span> - возвращает значение указанного выражения. Функция позволяет вычислять значения динамически сгенерированных выражений. Указанные параметры передаются в <a href="dict.htm#array">массиве</a> <span style="font-weight: bold;">ARGS</span>, а после вычисления выражения предыдущие значения ARGS восстанавливаются. Примеры:</div>
<p>&nbsp;</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;DYNEVAL('3+4')</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;PL DYNEVAL('mid(&quot;abcd&quot;,2,1)+&quot;qwerty&quot;')</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;PL DYNEVAL($test + ' + val(&quot;&lt;&lt;$test&gt;&gt;&quot;)')</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp;проход=DYNEVAL(&quot; $args[0] &lt;&gt; 'текст' &quot;, 'строка')</p>

</td></tr></table>

</body>
</html>
