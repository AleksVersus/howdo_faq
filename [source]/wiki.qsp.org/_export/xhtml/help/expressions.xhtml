<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>help:expressions</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="help,expressions"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Документация QSP"/>
<link rel="start" href="/"/>
<link rel="alternate" type="application/rss+xml" title="Недавние изменения" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Текущее пространство имён" href="/feed.php?mode=list&amp;ns=help"/>
<link rel="alternate" type="text/html" title="Простой HTML" href="/_export/xhtml/help/expressions"/>
<link rel="canonical" href="http://wiki.qsp.su/help/expressions"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=exportdokuwiki&amp;tseed=f78b359cebbc2738e83150069e877c7f"/>
<link rel="stylesheet" type="text/css" href="/lib/plugins/syntaxhighlighter3/sxh3/styles/shCore.css"/>
<link rel="stylesheet" type="text/css" href="/lib/plugins/syntaxhighlighter3/sxh3/styles/shThemeDefault.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='help';var JSINFO = {"id":"help:expressions","namespace":"help"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?tseed=f78b359cebbc2738e83150069e877c7f&amp;template=exportdokuwiki"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shCore.js"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shAutoloader.js"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shBrushXml.js"></script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Содержание</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="#vyrazhenija">Выражения</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#oboznachenija">Обозначения</a></div></li>
<li class="level3"><div class="li"><a href="#prioritet_operacij">Приоритет операций</a></div></li>
<li class="level3"><div class="li"><a href="#opisanie_operacij">Описание операций</a></div></li>
<li class="level3"><div class="li"><a href="#primery">Примеры</a></div></li>
<li class="level3"><div class="li"><a href="#sokraschennye_operacii_s_prisvoeniem">Сокращенные операции с присвоением</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<p>
<a href="/help/variables" class="wikilink1" title="help:variables">Назад: Переменные</a>
</p>

<h2 class="sectionedit1" id="vyrazhenija">Выражения</h2>
<div class="level2">

<p>
Выражение - набор констант, переменных, функций, связанных различными операциями. При записи выражений возможно использование скобок.
</p>

</div>
<!-- EDIT1 SECTION "Выражения" [54-331] -->
<h3 class="sectionedit2" id="oboznachenija">Обозначения</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <em>[выр]</em> - выражение может быть как текстового, так и числового типа.</div>
</li>
<li class="level1"><div class="li"> <em>[<strong>$</strong>выр]</em> - выражение текстового (строкового) типа (но при необходимости движок автоматически переведёт число в строку).</div>
</li>
<li class="level1"><div class="li"> <em>[<strong>#</strong>выр]</em> - выражение числового типа (если возможно, движок автоматически переведёт строку в число).</div>
</li>
</ul>

<p>
<strong>Примечение.</strong> Символ &#039;<strong>#</strong>&#039; использован в справке только чтобы разделить выражения произвольного и числового типов. К синтаксису QSP данный символ отношения <em class="u">не</em> имеет.
</p>

</div>
<!-- EDIT2 SECTION "Обозначения" [332-1207] -->
<h3 class="sectionedit3" id="prioritet_operacij">Приоритет операций</h3>
<div class="level3">

<p>
Операции перечислены в порядке убывания приоритетов (с одинаковым приоритетом находятся на одной строке).
</p>
<ul>
<li class="level1"><div class="li"> <strong>(</strong><em>[выр]</em><strong>)</strong> - выражения в скобках</div>
</li>
<li class="level1"><div class="li"> <strong>+</strong>, <strong>-</strong> (унарные)</div>
</li>
<li class="level1"><div class="li"> <strong></strong>*, <strong>/</strong></div>
</li>
<li class="level1"><div class="li"> <strong>MOD</strong></div>
</li>
<li class="level1"><div class="li"> <strong>+</strong>, <strong>-</strong></div>
</li>
<li class="level1"><div class="li"> <strong>=</strong>, <strong>&lt;</strong>, <strong>&gt;</strong>, <strong>!</strong>, <strong>&lt;&gt;</strong>, <strong>&lt;=</strong>, <strong>&gt;=</strong>, <strong>=&lt;</strong>, <strong>=&gt;</strong></div>
</li>
<li class="level1"><div class="li"> <strong>OBJ</strong>, <strong>LOC</strong>, <strong>NO</strong></div>
</li>
<li class="level1"><div class="li"> <strong>AND</strong></div>
</li>
<li class="level1"><div class="li"> <strong>OR</strong></div>
</li>
<li class="level1"><div class="li"> <strong>&amp;</strong></div>
</li>
</ul>

<p>
<strong>Примечание.</strong> В плеерах на последних версиях библиотеки (т.е. Quest Navigator и те, о которых автору статьи неизвестно) операция <strong>&amp;</strong> по приоритету находится между сложением/вычитанием и сравнениями.
</p>
<ul>
<li class="level1"><div class="li"> Максимальная вложенность выражений - 30. Т.е. не глубже 30-ти открытых скобок.</div>
</li>
<li class="level1"><div class="li"> Максимальное количество операторов на одном уровне вложенности - 100.</div>
</li>
<li class="level1"><div class="li"> Операции с одинаковым приоритетом выполняются слева направо.</div>
</li>
</ul>

</div>
<!-- EDIT3 SECTION "Приоритет операций" [1208-2476] -->
<h3 class="sectionedit4" id="opisanie_operacij">Описание операций</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <strong>+</strong><em>[<strong>#</strong>выр]</em>, <strong>-</strong><em>[<strong>#</strong>выр]</em> - унарные плюс / минус. Находятся перед числовым выражением и меняют знак у значения этого выражения (в случае &quot;-&quot;).</div>
</li>
<li class="level1"><div class="li"> <strong>+</strong> , <strong>-</strong> , <strong></strong>*, <strong>/</strong> - сложение, вычитание, умножение, деление соответственно.<br/>
Операции записываются как <em>[<strong>#</strong>выр1]</em> <strong>[операция]</strong> <em>[<strong>#</strong>выр2]</em>.</div>
</li>
<li class="level1"><div class="li"> <em>[<strong>#</strong>выр1]</em> <strong>MOD</strong> <em>[<strong>#</strong>выр2]</em> - остаток от деления.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>[выр1]</em> <strong>=</strong> <em>[выр2]</em> - верно, если значения рядом стоящих выражений равны.</div>
</li>
<li class="level1"><div class="li"> <em>[выр1]</em> <strong>&lt;</strong> <em>[выр2]</em> - верно, если значение выражения слева меньше значения выражения справа.</div>
</li>
<li class="level1"><div class="li"> <em>[выр1]</em> <strong>&gt;</strong> <em>[выр2]</em> - верно, если значение выражения слева больше значения выражения справа.</div>
</li>
<li class="level1"><div class="li"> <em>[выр1]</em> <strong>!</strong> <em>[выр2]</em>, <em>[выр1]</em> <strong>&lt;&gt;</strong> <em>[выр2]</em> - верно, если значения рядом стоящих выражений не равны.</div>
</li>
<li class="level1"><div class="li"> <em>[выр1]</em> <strong>&lt;=</strong> <em>[выр2]</em>, <em>[выр1]</em> <strong>=&lt;</strong> <em>[выр2]</em> - верно, если значение выражения слева меньше или равно значению выражения справа.</div>
</li>
<li class="level1"><div class="li"> <em>[выр1]</em> <strong>&gt;=</strong> <em>[выр2]</em>, <em>[выр1]</em> <strong>=&gt;</strong> <em>[выр2]</em> - верно, если значение выражения слева больше или равно значению выражения справа.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <strong>OBJ</strong> <em>[<strong>$</strong>выр]</em> - верно, если в рюкзаке есть предмет <em>[<strong>$</strong>выр]</em>.</div>
</li>
<li class="level1"><div class="li"> <strong>LOC</strong> <em>[<strong>$</strong>выр]</em> - верно, если в игре есть локация с названием <em>[<strong>$</strong>выр]</em>.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <strong>NO</strong> <em>[<strong>#</strong>выр]</em> - побитовая инверсия <sup><a href="#fn__1" id="fnt__1" class="fn_top">1)</a></sup>. В основном используется как логическая инверсия.</div>
</li>
<li class="level1"><div class="li"> <em>[<strong>#</strong>выр1]</em> <strong>OR</strong> <em>[<strong>#</strong>выр2]</em> - операция побитового &quot;или&quot;. Во всём выражении будут равны единице те биты, которые равны единице хотя бы в одном из двух выражений.</div>
</li>
<li class="level1"><div class="li"> <em>[<strong>#</strong>выр1]</em> <strong>AND</strong> <em>[<strong>#</strong>выр2]</em> - операция побитового &quot;и&quot;. Во всём выражении будут равны единице те биты, которые равны единице в каждом из двух выражений.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <em>[<strong>$</strong>выр1]</em> <strong>&amp;</strong> <em>[<strong>$</strong>выр2]</em> - операция объединения строковых выражений. Подробнее см. <a href="/help/strings" class="wikilink1" title="help:strings">Строки</a>.</div>
</li>
</ul>

<p>
Верным считается числовое выражение, значение которого отлично от 0. При значении 0 выражение считается ложным. Для значения &quot;верно&quot; настоятельно рекомендуется использовать -1, т.к. только в этом случае будут адекватно работать побитовые операторы в роли логических.
</p>

</div>
<!-- EDIT4 SECTION "Описание операций" [2477-6033] -->
<h3 class="sectionedit5" id="primery">Примеры</h3>
<div class="level3">

<p>
<pre class="brush: qsp">
x=5
y=6
(x ! y) OR (x &lt;&gt; y)	&amp;! Результат -1
x OR y			&amp;! Двоичное 101 OR 110 = 111 Результат 7
x AND y 		&amp;! Двоичное 101 AND 110 = 100 Результат 4
y MOD x			&amp;! 6/5 -&gt; остаток 1 Результат 1
OBJ &#039;стул&#039;		&amp;! Если в инвентаре есть предмет &#039;стул&#039;, то результат -1, если нет, то 0
LOC &#039;дом&#039;		&amp;! Если в игре есть локация &#039;дом&#039;, то результат -1, если нет, то 0
res = x*y + y*-x/2	&amp;! (5*6) + (6*(-5)/2)=15  Результат 15
res = NO x = y		&amp;! NO 0 = -1  Результат -1

15*5/2			&amp;! (15*5)/2 = 75/2 = 37
15/2*5			&amp;! (15/2)*5 = 7*5 = 35
</pre>
</p>

</div>
<!-- EDIT5 SECTION "Примеры" [6034-6769] -->
<h3 class="sectionedit6" id="sokraschennye_operacii_s_prisvoeniem">Сокращенные операции с присвоением</h3>
<div class="level3">

<p>
Язык QSP поддерживает следующие сокращенные операции:
<pre class="brush: qsp">
x += y   &amp;! x = x+y
x -= y   &amp;! x = x-y
x /= y   &amp;! x = x/y
x *= y   &amp;! x = x*y
</pre>
</p>
<hr />

<p>
<a href="/help/coding" class="wikilink1" title="help:coding">Вперёд: Программный код</a>
</p>

</div>
<!-- EDIT6 SECTION "Сокращенные операции с присвоением" [6770-] --><div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
 <strong>NO</strong> <em>x</em> соответствует <em>-1-x</em>, откуда можно сделать вывод о кодировке отрицательных чисел</div>
</div>
</div>
</body>
</html>
