<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>help:realtime</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="help,realtime"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Документация QSP"/>
<link rel="start" href="/"/>
<link rel="alternate" type="application/rss+xml" title="Недавние изменения" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Текущее пространство имён" href="/feed.php?mode=list&amp;ns=help"/>
<link rel="alternate" type="text/html" title="Простой HTML" href="/_export/xhtml/help/realtime"/>
<link rel="canonical" href="http://wiki.qsp.su/help/realtime"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=exportdokuwiki&amp;tseed=f78b359cebbc2738e83150069e877c7f"/>
<link rel="stylesheet" type="text/css" href="/lib/plugins/syntaxhighlighter3/sxh3/styles/shCore.css"/>
<link rel="stylesheet" type="text/css" href="/lib/plugins/syntaxhighlighter3/sxh3/styles/shThemeDefault.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='help';var JSINFO = {"id":"help:realtime","namespace":"help"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?tseed=f78b359cebbc2738e83150069e877c7f&amp;template=exportdokuwiki"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shCore.js"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shAutoloader.js"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shBrushXml.js"></script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Содержание</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="#realnoe_vremja">Реальное время</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#sobytija_v_realnom_vremeni_tajmer">События в реальном времени. Таймер</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#realizacija_vremeni_v_igre">Реализация времени в игре</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<p>
<a href="/help/modules" class="wikilink1" title="help:modules">Назад: Работа с файлами, использование модулей</a>
</p>

<h2 class="sectionedit1" id="realnoe_vremja">Реальное время</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> <strong>WAIT</strong> <em>[#миллисекунды]</em> - остановка выполнения программы на заданное количество миллисекунд (1 секунда = 1000 миллисекунд).</div>
</li>
<li class="level1"><div class="li"> <strong>MSECSCOUNT</strong> - возвращает количество миллисекунд, прошедших с момента начала игры.</div>
</li>
</ul>

</div>
<!-- EDIT1 SECTION "Реальное время" [104-512] -->
<h3 class="sectionedit2" id="sobytija_v_realnom_vremeni_tajmer">События в реальном времени. Таймер</h3>
<div class="level3">

<p>
В QSP есть возможность выполнять код через определённые промежутки времени — для этого используется локация-счётчик.
</p>

<p>
Чтобы локация-счётчик заработала, необходимо внести её название в служебную переменную <strong>$COUNTER</strong>. Например, если ваша локация-счётчик называется <strong>«Счётчик»</strong>, на самой первой локации в игре нужно написать:<pre class="brush: qsp">$COUNTER=&#039;Счётчик&#039;</pre>Как правило, чтобы не путаться, локацию называют так же, как и служебную переменную —<strong>«Counter»</strong>:<pre class="brush: qsp">$COUNTER=&#039;Counter&#039;</pre>
</p>

<p>
Затем на созданной локации-счётчике пишут код, который должен выполняться через определённые промежутки времени.
</p>

<p>
По-умолчанию, код на локации-счётчике выполняется каждые пол секунды (500 миллисекунд). Но это значение можно изменить, использовав оператор <strong>SETTIMER</strong>:<pre class="brush: qsp">! устанавливает период выполнения кода
! на локации-счётчике в 100 миллисекунд
SETTIMER 100</pre>Комбинируя возможности операторов, функций и локации-счётчика, можно задавать множество событий, выполняемых в реальном времени.
Для примера приведён код локации-счётчика, который будет выводить строки текста одну за одной каждые полторы секунды:<pre class="brush: qsp">settimer 20
if стихотворение=0:
	if время_первая_строка=0:
		время_первая_строка=msecscount+1500
	end
	if msecscount&gt;=время_первая_строка:
		*pl &#039;Веленью совести, о Муза, будь послушна!&#039;
		стихотворение=1
	end
end
if стихотворение=1:
	if время_вторая_строка=0:
		время_вторая_строка=msecscount+1500
	end
	if msecscount&gt;=время_вторая_строка:
		*pl &#039;Обиды не страшась, не требуя венца,&#039;
		стихотворение=2
	end
end
if стихотворение=2:
	if время_третья_строка=0:
		время_третья_строка=msecscount+1500
	end
	if msecscount&gt;=время_третья_строка:
		*pl &#039;Хвалу и клевету приемли равнодушно&#039;
		стихотворение=3
	end
end
if стихотворение=3:
	if время_четвёртая_строка=0:
		время_четвёртая_строка=msecscount+1500
	end
	if msecscount&gt;=время_четвёртая_строка:
		*pl &#039;И не оспаривай глупца.&#039;
		стихотворение=4
	end
end</pre>
</p>

</div>
<!-- EDIT2 SECTION "События в реальном времени. Таймер" [513-3763] -->
<h2 class="sectionedit3" id="realizacija_vremeni_v_igre">Реализация времени в игре</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> <a href="http://qsp.su/index.php?option=com_agora&amp;task=topic&amp;id=956&amp;Itemid=57" class="urlextern" title="http://qsp.su/index.php?option=com_agora&amp;task=topic&amp;id=956&amp;Itemid=57"  rel="nofollow">Юлианских календарь от evp</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://qsp.su/index.php?option=com_agora&amp;task=topic&amp;id=956&amp;Itemid=57" class="urlextern" title="http://qsp.su/index.php?option=com_agora&amp;task=topic&amp;id=956&amp;Itemid=57"  rel="nofollow">Реализация игрового времени</a></div>
</li>
</ol>

<p>
<a href="/help/classic_qsp" class="wikilink1" title="help:classic_qsp">Вперёд: Классический плеер</a>
</p>

</div>
<!-- EDIT3 SECTION "Реализация времени в игре" [3764-] --></div>
</body>
</html>
