<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>howto:arrays</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="howto,arrays"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Документация QSP"/>
<link rel="start" href="/"/>
<link rel="alternate" type="application/rss+xml" title="Недавние изменения" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Текущее пространство имён" href="/feed.php?mode=list&amp;ns=howto"/>
<link rel="alternate" type="text/html" title="Простой HTML" href="/_export/xhtml/howto/arrays"/>
<link rel="canonical" href="http://wiki.qsp.su/howto/arrays"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=exportdokuwiki&amp;tseed=f78b359cebbc2738e83150069e877c7f"/>
<link rel="stylesheet" type="text/css" href="/lib/plugins/syntaxhighlighter3/sxh3/styles/shCore.css"/>
<link rel="stylesheet" type="text/css" href="/lib/plugins/syntaxhighlighter3/sxh3/styles/shThemeDefault.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='howto';var JSINFO = {"id":"howto:arrays","namespace":"howto"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?tseed=f78b359cebbc2738e83150069e877c7f&amp;template=exportdokuwiki"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shCore.js"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shAutoloader.js"></script>
<script type="text/javascript" src="/lib/plugins/syntaxhighlighter3/sxh3/scripts/shBrushXml.js"></script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Содержание</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="#prodvinutoe_ispolzovanie_massivov">Продвинутое использование массивов</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#dvumernye_massivy_s_chislovymi_indeksami">Двумерные массивы с числовыми индексами</a></div></li>
<li class="level3"><div class="li"><a href="#dvumernye_massivy_s_tekstovymi_indeksami">Двумерные массивы с текстовыми индексами</a></div></li>
<li class="level3"><div class="li"><a href="#massiv_peremennyx">Массив переменных</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h2 class="sectionedit1" id="prodvinutoe_ispolzovanie_massivov">Продвинутое использование массивов</h2>
<div class="level2">

</div>
<!-- EDIT1 SECTION "Продвинутое использование массивов" [1-78] -->
<h3 class="sectionedit2" id="dvumernye_massivy_s_chislovymi_indeksami">Двумерные массивы с числовыми индексами</h3>
<div class="level3">

<p>
Пример симуляции двумерного массива
</p>

<p>
<pre class="brush: qsp">
! Индексы i1  0..8
i1_max=9    

! Индексы i2  0..5
i2_max=6

! Заполнение данных массива 
i1=0
:ПрыгЗадатьМассив1
	i2=0
	:ПрыгЗадатьМассив2
		$ДвумерныйМассив[i1*i2_max+i2]=&#039;[&lt;&lt;i1&gt;&gt;,&lt;&lt;i2&gt;&gt;]&#039;
		i2+=1
	if i2&lt;i2_max : Jump &#039;ПрыгЗадатьМассив2&#039;
i1+=1
if i1&lt;i1_max : Jump &#039;ПрыгЗадатьМассив1&#039;


! Вывод данных массива
i1=0
:ПрыгВыводМассива1
	*Nl 
	i2=0
	:ПрыгВыводМассива2
		*P $ДвумерныйМассив[i1*i2_max+i2]+&#039;  &#039;
		i2+=1
	if i2&lt;i2_max : Jump &#039;ПрыгВыводМассива2&#039;
i1+=1
if i1&lt;i1_max : Jump &#039;ПрыгВыводМассива1&#039;
*Nl 

!{Результат 
[0,0]  [0,1]  [0,2]  [0,3]  [0,4]  [0,5]  
[1,0]  [1,1]  [1,2]  [1,3]  [1,4]  [1,5]  
[2,0]  [2,1]  [2,2]  [2,3]  [2,4]  [2,5]  
[3,0]  [3,1]  [3,2]  [3,3]  [3,4]  [3,5]  
[4,0]  [4,1]  [4,2]  [4,3]  [4,4]  [4,5]  
[5,0]  [5,1]  [5,2]  [5,3]  [5,4]  [5,5]  
[6,0]  [6,1]  [6,2]  [6,3]  [6,4]  [6,5]  
[7,0]  [7,1]  [7,2]  [7,3]  [7,4]  [7,5]  
[8,0]  [8,1]  [8,2]  [8,3]  [8,4]  [8,5]  
}

!Получение индексов массива через функцию ARRPOS

$Поиск=&#039;[2,5]&#039;

i1=ARRPOS(&#039;$ДвумерныйМассив&#039;,$Поиск)/i2_max
i2=ARRPOS(&#039;$ДвумерныйМассив&#039;,$Поиск) mod i2_max

if ARRPOS(&#039;$ДвумерныйМассив&#039;,$Поиск)&lt;&gt;-1 :
	 *Nl $Поиск+&#039;=[&lt;&lt;i1&gt;&gt;,&lt;&lt;i2&gt;&gt;]&#039; 
else 
	*Nl &#039;Элемент не найден&#039;
end
!{Результат 
[2,5]=[2,5]
}

</pre>
</p>

<p>
В данном примере использованы функции:
</p>
<ul>
<li class="level1"><div class="li"> <a href="/help/conditional" class="wikilink1" title="help:conditional">&#039;IF [#условие]: [операторы] ELSE [операторы]&#039;</a></div>
</li>
<li class="level3"><div class="li"> <a href="/help/main" class="wikilink1" title="help:main">&#039;*NL [$текст]&#039;</a></div>
</li>
<li class="level3"><div class="li"> <a href="/help/jump" class="wikilink1" title="help:jump">&#039;JUMP [$метка]&#039;</a></div>
</li>
<li class="level3"><div class="li"> <a href="/help/arrays" class="wikilink1" title="help:arrays">&#039;ARRPOS([#начало],[$имя_массива],[значение])&#039;</a></div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "Двумерные массивы с числовыми индексами" [79-2166] -->
<h3 class="sectionedit3" id="dvumernye_massivy_s_tekstovymi_indeksami">Двумерные массивы с текстовыми индексами</h3>
<div class="level3">

<p>
Пример работы с массивом имеющим текстовые индексы
<pre class="brush: qsp">
! Индексы i1  0..3
i1_max=4    

! Индексы i2  0..5
i2_max=6

! Заполнение данных массива 
i1=0
:ПрыгЗадатьМассив1
	i2=0
	:ПрыгЗадатьМассив2
		! Знак двоеточие используется как разделитель 
		! между двумя численными индексами переведенными в текст
		$ДвумерныйМассивТекстовыйИндекс[&#039;&lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;]=&#039;[&lt;&lt;i1&gt;&gt;,&lt;&lt;i2&gt;&gt;]&#039;
		! $МассивИндекс нужен для дальнейшего поиска через ARRPOS/ARRCOMP
		$МассивИндекс[&#039;&lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;]=&#039;&lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;
		! МассивПорядок нужен для использования KILLVAR
		МассивПорядок[&#039;&lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;]=ARRSIZE(&#039;МассивПорядок&#039;)
		! Добавлять новый элемент и удалять нужно 
		!только одновременно в 3х массивах
		
		i2+=1
	if i2&lt;i2_max : Jump &#039;ПрыгЗадатьМассив2&#039;
i1+=1
if i1&lt;i1_max : Jump &#039;ПрыгЗадатьМассив1&#039;


! Вывод данных массива
i1=0
:ПрыгВыводМассива1
	*Nl 
	i2=0
	:ПрыгВыводМассива2
		*P $ДвумерныйМассивТекстовыйИндекс[&#039;&lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;]+&#039;  &#039;
		i2+=1
	if i2&lt;i2_max : Jump &#039;ПрыгВыводМассива2&#039;
i1+=1
if i1&lt;i1_max : Jump &#039;ПрыгВыводМассива1&#039;

*Nl 

!{ Результат 
[0,0]  [0,1]  [0,2]  [0,3]  [0,4]  [0,5]  
[1,0]  [1,1]  [1,2]  [1,3]  [1,4]  [1,5]  
[2,0]  [2,1]  [2,2]  [2,3]  [2,4]  [2,5]  
[3,0]  [3,1]  [3,2]  [3,3]  [3,4]  [3,5]  
}


!Получение индексов массива через функцию ARRPOS
$Поиск=&#039;[3,0]&#039;

N=ARRPOS(&#039;$ДвумерныйМассивТекстовыйИндекс&#039;,$Поиск)
if N&lt;&gt;-1:
	!Ищем разделитель &#039;:&#039;  в индексе
	K=STRPOS($МассивИндекс[N],&#039;:&#039;)

	i1=VAL(MID($МассивИндекс[N],0,K-1))
	i2=VAL(MID($МассивИндекс[N],K+1,LEN($МассивИндекс[N])-K))

	*NL $Поиск+&#039;=[&lt;&lt;i1&gt;&gt;,&lt;&lt;i2&gt;&gt;]&#039;
else
	*Nl &#039;Элемент не найден&#039;
end


!{ Результат 
[3,0]=[3,0]
}

*NL
!Удаление элемента массива через текстовый индекс
$Удалить=&#039;&lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;
*NL &#039;Удаляем элемент с индексом &lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;

!Получаем номер элемента

N=МассивПорядок[$Удалить]


!Удаляем элемент
KILLVAR &#039;$ДвумерныйМассивТекстовыйИндекс&#039;, N
KILLVAR &#039;$МассивИндекс&#039;, N
KILLVAR &#039;МассивПорядок&#039;, N

!Еще раз выводим данные массива

i1=0
:ПрыгВыводМассива3
	*Nl 
	i2=0
	:ПрыгВыводМассива4
		if $ДвумерныйМассивТекстовыйИндекс[&#039;&lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;]&lt;&gt;&#039;&#039;:
			*P $ДвумерныйМассивТекстовыйИндекс[&#039;&lt;&lt;i1&gt;&gt;:&lt;&lt;i2&gt;&gt;&#039;]+&#039;  &#039;
		else
			*P &#039;[DEL]  &#039;
		end
		i2+=1
	if i2&lt;i2_max : Jump &#039;ПрыгВыводМассива4&#039;
i1+=1
if i1&lt;i1_max : Jump &#039;ПрыгВыводМассива3&#039;



!{ Результат
Удаляем элемент с индексом 3:0
[0,0]  [0,1]  [0,2]  [0,3]  [0,4]  [0,5]  
[1,0]  [1,1]  [1,2]  [1,3]  [1,4]  [1,5]  
[2,0]  [2,1]  [2,2]  [2,3]  [2,4]  [2,5]  
[DEL]  [3,1]  [3,2]  [3,3]  [3,4]  [3,5]  
}

</pre>
</p>

<p>
В данном примере использованы функции:
</p>
<ul>
<li class="level1"><div class="li"> <a href="/help/arrays" class="wikilink1" title="help:arrays">&#039;ARRSIZE([$имя])&#039;</a></div>
</li>
<li class="level3"><div class="li"> <a href="/help/arrays" class="wikilink1" title="help:arrays">&#039;ARRPOS([#начало],[$имя_массива],[значение])&#039;</a></div>
</li>
<li class="level3"><div class="li"> <a href="/help/arrays" class="wikilink1" title="help:arrays">&#039;KILLVAR [$название массива],[#индекс элемента]&#039;</a></div>
</li>
<li class="level3"><div class="li"> <a href="/help/strings" class="wikilink1" title="help:strings">&#039;VAL([$стр])&#039;</a></div>
</li>
<li class="level3"><div class="li"> <a href="/help/strings" class="wikilink1" title="help:strings">&#039;MID([$стр],[#начало],[#длина])&#039;</a></div>
</li>
<li class="level3"><div class="li"> <a href="/help/strings" class="wikilink1" title="help:strings">&#039;LEN([$стр])&#039;</a></div>
</li>
</ul>

</div>
<!-- EDIT3 SECTION "Двумерные массивы с текстовыми индексами" [2167-6283] -->
<h3 class="sectionedit4" id="massiv_peremennyx">Массив переменных</h3>
<div class="level3">

<p>
Пример использования индекса в названии массива
</p>

<p>
<pre class="brush: qsp">
! Индексы i1  0..5
i1_max=6    

! Индексы i2  0..2
i2_max=3

! Заполнение данных массива 
i1=0
:ПрыгЗадатьМассив1
	i2=0
	:ПрыгЗадатьМассив2
	!названия заполняемых массивов 
	!$МассивПеременных0 , $МассивПеременных1 , $МассивПеременных2
		DYNAMIC {$МассивПеременных}+i1+{[&#039;&lt;&lt;i2&gt;&gt;&#039;]=&#039;[&lt;&lt;i1&gt;&gt;,&lt;&lt;i2&gt;&gt;]&#039; }
		i2+=1
	if i2&lt;i2_max : Jump &#039;ПрыгЗадатьМассив2&#039;
i1+=1
if i1&lt;i1_max : Jump &#039;ПрыгЗадатьМассив1&#039;


! Вывод данных массива
i1=0
:ПрыгВыводМассива1
	*Nl 
	i2=0
	:ПрыгВыводМассива2
		DYNAMIC {*P $МассивПеременных}+i1+{[&#039;&lt;&lt;i2&gt;&gt;&#039;] +&#039;  &#039;} 
		i2+=1
	if i2&lt;i2_max : Jump &#039;ПрыгВыводМассива2&#039;
i1+=1
if i1&lt;i1_max : Jump &#039;ПрыгВыводМассива1&#039;

!{ Результат 
[0,0]  [0,1]  [0,2]  
[1,0]  [1,1]  [1,2]  
[2,0]  [2,1]  [2,2]  
[3,0]  [3,1]  [3,2]  
[4,0]  [4,1]  [4,2]  
[5,0]  [5,1]  [5,2]   
}

</pre>
</p>

<p>
В данном примере использованы функции:
</p>
<ul>
<li class="level1"><div class="li"> <a href="/help/dynamical" class="wikilink1" title="help:dynamical">&#039;DYNAMIC [$код],[параметр 1],[параметр 2], …&#039;</a></div>
</li>
</ul>
<hr />

<p>
<a href="/howto/start" class="wikilink1" title="howto:start">Назад: Как сделать</a>
</p>

</div>
<!-- EDIT4 SECTION "Массив переменных" [6284-] --></div>
</body>
</html>
