<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <link id="favicon" rel="icon" type="image/x-icon" href="../res/favicon.ico" />
    <link type="text/css" rel="stylesheet" href="../res/css/easy.library.css" />
    <link type="text/css" rel="stylesheet" href="../res/css/offline.window.css" />
    <link type="text/css" rel="stylesheet" href="../res/css/qsp_code.css" />
    <title>QSP: ИнформАрхив</title>
</head>
    
<body>
    <div class="em_Main">
        <div class="em_AROUND">
            <h1>ИнформАрхив QSP</h1>
            <!-- body start -->
<div style="display:flex;justify-content:space-between;"><div><a href="https://aleksversus.github.io/howdo_faq/informarch/avtomatnoe_programmirovanie_0009.html" class="emHREFTT">&lt; Назад, к странице 11</a></div><div><a href="https://aleksversus.github.io/howdo_faq/informarch/rabota_v_tekstovom_redaktore_0011.html" class="emHREFTT">Вперёд, к странице 13 &gt;</a></div></div>
<h5 id="informarch_txt2gam_manual">TXT2GAM. Краткое руководство</h5><p>
Утилита "TXT2GAM" ("txt2gam.exe") предназначена для конвертирования текстовых файлов, написанных в специальном формате, в файлы QSP-игр `.qsp`. Таким образом вы можете создавать игры в обычном текстовом редакторе, а затем конвертировать их в приемлемые для плееров файлы.
</p>
<p>
<a href="https://qsp.org/attachments/txt2gam011.zip" style="text-decoration:none;" class="emFOLD">Скачать утилиту</a>
</p>
<h5 id="format-txt2gam">Формат TXT2GAM</h5><p>
Файлы в формате TXT2GAM — это обычные текстовые файлы, в которых мы размещаем код QSP, при этом данный код нужно записывать по определённым правилам.
</p>
<p>
Начало локации отмечается символом `#` (решётка/диез), после которого должен стоять пробел и название локации. Например так:
</p>
<div class="Monokai-Code">
<span class="Monokai-StartLoc">#&nbsp;начало</span><br/>
</div>
<p>
Конец локации обозначается символом `-` (дефис) в отдельной строке. После этого символа в той же строке могут идти любые символы, например, снова название локации:
</p>
<div class="Monokai-Code">
<span class="Monokai-Operator">-</span>&nbsp;начало<br/>
</div>
<p>
Между началом и концом локации записывается обычный код QSP, как если бы вы его писали в поле "Выполнить при посещении" редактора Quest Generator. Вот пример кода в формате TXT2GAM с двумя локациями:
</p>
<div class="Monokai-Code">
<span class="Monokai-StartLoc">#&nbsp;Начало</span><br/>
<span class="Monokai-String">'It'</span><span class="Monokai-String">'s&nbsp;only&nbsp;test&nbsp;of&nbsp;new&nbsp;utility.'</span><br/>
<span class="Monokai-String">'That&nbsp;is&nbsp;all.'</span><br/>
<span class="Monokai-Koperator">act</span>&nbsp;<span class="Monokai-String">'Далее'</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">goto</span>&nbsp;<span class="Monokai-String">'next'</span><br/>
<span class="Monokai-Koperator">end</span><span class="Monokai-EndLoc"><br/>
-&nbsp;(конец&nbsp;локации)</span><span class="Monokai-StartLoc"><br/>
<br/>
#&nbsp;next</span><br/>
$s<span class="Monokai-Operator">=</span><span class="Monokai-String">'Это&nbsp;последняя&nbsp;локация&nbsp;примера.'</span><br/>
i<span class="Monokai-Operator">=</span><span class="Monokai-Numeric">1</span><span class="Monokai-Markup"><br/>
:loop</span><br/>
<span class="Monokai-Koperator">if</span>&nbsp;i<span class="Monokai-Operator">&lt;=</span><span class="Monokai-Func">len</span><span class="Monokai-Operator">(</span>$s<span class="Monokai-Operator">)</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">*</span><span class="Monokai-Operator">p</span>&nbsp;<span class="Monokai-Func">$mid</span><span class="Monokai-Operator">(</span>$s<span class="Monokai-Operator">,</span>i<span class="Monokai-Operator">,</span><span class="Monokai-Numeric">1</span><span class="Monokai-Operator">)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">wait</span>&nbsp;<span class="Monokai-Numeric">200</span><br/>
&nbsp;&nbsp;&nbsp;i<span class="Monokai-Operator">=</span>i<span class="Monokai-Operator">+</span><span class="Monokai-Numeric">1</span><br/>
&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">jump</span>&nbsp;<span class="Monokai-String">'loop'</span><br/>
<span class="Monokai-Koperator">end</span><br/>
<span class="Monokai-Operator">*</span><span class="Monokai-Operator">nl</span>&nbsp;<span class="Monokai-Operator">&amp;</span>&nbsp;<span class="Monokai-String">'Это&nbsp;всё.'</span><span class="Monokai-EndLoc"><br/>
-</span><br/>
</div>
<p>
Между локациями в таком файле может быть записан любой текст, он не попадёт в конечный файл игры. Поэтому вы можете помещать туда различные комментарии, команды препроцессора и другой сопроводительный текст.
</p>
<p>
Поскольку концом локации считается символ `-` в начале отдельно стоящей строки, могут возникнуть ошибки, если вы напишете команду, наподобие этой:
</p>
<div class="Monokai-Code">
<span class="Monokai-Operator">-</span><span class="Monokai-Operator">(</span>x<span class="Monokai-Operator">+</span><span class="Monokai-Numeric">23</span><span class="Monokai-Operator">)</span><br/>
</div>
<p>
Записанная в поле "Выполнить при посещении" редактора Quest Generator данная команда будет нормально работать в итоговой игре, однако если эту команду записать в файле формата TXT2GAM, конвертер посчитает её окончанием локации, и все последующие за данной командой строки вплоть до начала следующей локации будут проигнорированы.
</p>
<div class="Monokai-Code">
<span class="Monokai-StartLoc">#&nbsp;начало</span><br/>
<span class="Monokai-String">"Какой-то&nbsp;код.&nbsp;Много-много&nbsp;кода<br/>
Этот&nbsp;код&nbsp;попадёт&nbsp;в&nbsp;локацию"</span><span class="Monokai-Operator"><br/>
</span><span class="Monokai-Comment">!&nbsp;пытаемся&nbsp;вывести&nbsp;произведение&nbsp;45&nbsp;и&nbsp;9&nbsp;умноженное&nbsp;на&nbsp;-1</span><span class="Monokai-EndLoc"><br/>
-(45*9)</span><br/>
<span class="Monokai-String">"А&nbsp;вот&nbsp;этот&nbsp;код&nbsp;не&nbsp;попадёт&nbsp;в&nbsp;локацию"</span><span class="Monokai-EndLoc"><br/>
-&nbsp;начало&nbsp;(хотим,&nbsp;чтобы&nbsp;конец&nbsp;локации&nbsp;был&nbsp;здесь)</span><br/>
Все&nbsp;строки&nbsp;от<span class="Monokai-EndLoc">&nbsp;-(45*9)&nbsp;будут&nbsp;проигнорированы</span><span class="Monokai-StartLoc"><br/>
<br/>
#&nbsp;локация&nbsp;2</span><span class="Monokai-Operator"><br/>
</span><span class="Monokai-Comment">!&nbsp;какой-то&nbsp;код</span><span class="Monokai-EndLoc"><br/>
-&nbsp;локация&nbsp;2</span><br/>
</div>
<p>
Если не закрыть локацию строкой начинающейся с `-`, новую локацию открыть будет нельзя, а значит строка, начинающаяся с символа `#` может вызвать ошибку "Неизвестное действие" в конечной игре:
</p>
<div class="Monokai-Code">
<span class="Monokai-StartLoc">#&nbsp;начало</span><br/>
<span class="Monokai-String">"Выводим&nbsp;текст"</span><span class="Monokai-StartLoc"><br/>
#&nbsp;локация&nbsp;2</span><br/>
<span class="Monokai-String">"Забыли&nbsp;закрыть&nbsp;локацию&nbsp;перед&nbsp;открытием&nbsp;новой"</span><span class="Monokai-EndLoc"><br/>
-&nbsp;локация&nbsp;2</span><br/>
</div>
<p>
Внимание! Для формата TXT2GAM не предусмотрено редактирование базового описания и базовых действий. Поэтому при экспорте игры из Quest Generator в формат TXT2GAM будьте внимательны: все базовые описания и базовые действия будут экспортированы в основной код локаций. Если впоследствии вы импортируете игру обратно из TXT2GAM-файла в Quest Generator, то поля "Описание" и "Базовые действия" во всех локациях окажутся пустыми.
</p>
<h5 id="ispol_zovanie-utility-txt2gam">Использование утилиты TXT2GAM</h5><p>
TXT2GAM — это консольная утилита, т.е. она запускается командами из консоли, например из командной строки Windows. Ознакомиться с основными командами командной строки вы можете в обучающей статье <a href="https://sonikelf.ru/vvodnaya-statya-po-rabote-v-konsoli-chto-takoe-konsol-komandy-konsoli-i-prochee-takoe-raznoe-cmd/" style="text-decoration:none;" class="emFOLD">"Что такое консоль, команды и прочее такое разное — CMD"</a>.
</p>
<p>
Пример работы с утилитой:
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;game.txt&nbsp;game.qsp
</div>
<p>
Здесь: `game.txt` — исходный файл вашей игры, написанный в формате TXT2GAM; `game.qsp` — конечный файл, в котором будет сохранена ваша игра.
</p>
<p>
Предположим, вы написали игру в текстовом редакторе, и теперь она у вас лежит в виде файла `game.txt` на диске "`D:`" в папке "`QSP\Games\myCoolGame`".
</p>
<p>
Для удобства скопируйте утилиту TXT2GAM (т.е. файл `txt2gam.exe`) в папку с игрой. Теперь для конвертирования игры вам нужно сделать следующее:
</p>
<ol>
<li>Откройте консоль</li>
<li>Перейдите на диск "`D:`", введя команду `D:` в командной строке и нажав клавишу "Enter".</li>
<li>Перейдите в папку с вашей игрой с помощью команды `cd`. В нашем примере это делается так `cd "QSP\Games\myCoolGame"`</li>
<li><p>
Запустите утилиту TXT2GAM, указав в качестве параметров сначала исходный файл вашей игры (т.е. `game.txt`), а затем название файла, который хотите получить, например `myCoolGame.qsp`:</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;game.txt&nbsp;myCoolGame.qsp
</div>
</li>
</ol>
<p>
Утилита поддерживает полные пути к файлам, поэтому вы можете использовать одну утилиту для конвертирования разных игр:
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;"D:\QSP\Games\myCoolGame\game.txt"&nbsp;"D:\QSP\releases\myCoolGame\myCoolGame.qsp"
</div>
<p>
Для получения дополнительной информации об утилите, запустите её в консоли без параметров:
</p>
<div class="Monokai-Code">
txt2gam.exe
</div>
<p>
Если указать ключ `u`, исходный файл будет обрабатываться как Unicode-файл (кодировка UCS-2 LE / UTF-16 LE):
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;game.txt&nbsp;myCoolGame.qsp&nbsp;u<br/>
</div>
<h5 id="dopolnitel_nye-vozmozhnosti-utility">Дополнительные возможности утилиты</h5><h5 id="ispol_zovanie">Использование</h5><p>
Общий вид команды для консоли:
</p>
<div class="Monokai-Code">
txt2gam&nbsp;[txt&nbsp;file]&nbsp;[output&nbsp;file]&nbsp;[options]
</div>
<h5 id="optsii-options">Опции. [Options]</h5><p>
a, A — режим ANSI. По-умолчанию утилита работает в режиме Unicode (UCS-2 / UTF-16).
</p>
<p>
u, U — режим Unicode (UCS-2 LE/ UTF-16 LE).
</p>
<p>
o, O — сохранить игру в старом формате (`.gam`). По умолчанию используется новый формат (`.qsp`).
</p>
<p>
s[char], S[char] — вместо [char] нужно указать символ, с которого начинаются ваши локации. Т.е. это символ, который вы можете использовать вместо `#`, если это необходимо.
</p>
<p>
e[char], E[char] — вместо [char] нужно указать символ, которым будет отмечаться конец локации. Т.е. это символ, который вы можете использовать вместо `-`, если это необходимо.
</p>
<p>
p[pass], P[pass] — вместо [pass] укажите пароль, который хотите установить на игру. По умолчанию `No`. Если пароль содержит пробелы, заключите его в кавычки.
</p>
<p>
t, T — извлечь строки из текста.
</p>
<p>
q, Q - извлечь q-строки из текста.
</p>
<h5 id="primery-vyzova">Примеры вызова:</h5><div class="Monokai-Code">
txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;pMyPassword
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;u
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;o&nbsp;pMyPassword
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;o&nbsp;e@&nbsp;pMyPassword
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;u&nbsp;o&nbsp;p"My&nbsp;Password"
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;o
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;o&nbsp;e@
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;s@&nbsp;e~
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;s@&nbsp;e~&nbsp;o
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;t&nbsp;u
</div>
<h5 id="podkliuchenie-utility-k-tekstovomu-redaktoru">Подключение утилиты к текстовому редактору</h5><p>
При разработке игр в текстовом редакторе, очень полезным может оказаться создание специального действия / кнопки для автоматической компиляции файла в `.qsp` и запуска плеера сразу с редактируемым файлом.
</p>
<p>
То есть пишете текст игры в редакторе, нажимаете некое сочетание клавиш и получаете запущенную в плеере игру.
</p>
<p>
Данное руководство, на примере `<a href="http://www.emeditor.com" style="text-decoration:none;" class="emFOLD">EmEditor</a>`а , описывает, как это сделать.
</p>
<p>
Для начала, создайте папку (допустим, `D:\Games\QSP`), распаковав в неё базовый архив плеера (`qspgui.exe` + все `DLL`ки) и архив утилиты TXT2GAM.
</p>
<p>
Далее, создайте в этой папке (рядом с `qspgui.exe`, `txt2gam.exe`) файл `start.bat` со следующим содержимым:
</p>
<div class="Monokai-Code">
txt2gam&nbsp;%1&nbsp;%2
<br/>start&nbsp;qspgui&nbsp;%2
</div>
<p>
Теперь нужно в редакторе добавить действие / кнопку, при нажатии на которую будет запущен файл `start.bat` с двумя аргументами - указанием исходного TXT файла и конечного `.qsp`-файла.
</p>
<ol>
<li>Запустите EmEditor, выберите в меню `Tools / External Tools / Customize Tools...`</li>
<li>В появившемся окошке нажмите кнопку `New`.</li>
<li>В поле `Title` впишите название действия (например, "QSP").</li>
<li>В поле `Command` строку `D:\Games\QSP\start.bat`</li>
<li>В поле `Arguments` строку `"$(Path)" "$(Dir)\$(Filename).gam"` (сохраняя кавычки)</li>
<li>В поле `Initial Directory` строчку `D:\Games\QSP`</li>
<li>Затем поставьте флажок напротив `Save File`, и нажмите `OK`.</li>
<li>На панели инструментов появится новая кнопка с подписью "QSP", при нажатии на которую будут произведены требуемые действия.</li>
</ol>
<p>
Теперь нужно назначить сочетание клавиш для кнопки.
</p>
<ol>
<li>Выберите пункт меню `Help / Keyboard Map...`. В категории `External Tools` найдите пункт `QSP` (обычно, в самом низу) и щелкните по нему 2 раза.</li>
<li>Установите курсор в поле `Press New Shortcut Key` и нажмите желаемое сочетание клавиш (к примеру, F1). Станет доступной кнопка `Assign`. Нажимаем.</li>
<li>Далее жмём `OK` и пишем игры в формате TXT2GAM :-)</li>
</ol>
<p>
Чтобы установить пароль на файл, создаваемый утилитой TXT2GAM, замените в файле `start.bat` строчку
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;%1&nbsp;%2
</div>
<p>
на
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;%1&nbsp;%2&nbsp;pMyPassword
</div>
<p>
где `MyPassword` - устанавливаемый пароль. Для задания паролей с пробелами, строчка pMyPassword должна быть указана в кавычках:
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;%1&nbsp;%2&nbsp;"pMy&nbsp;Pass&nbsp;word"
</div>
<h5 id="primechaniia">Примечания:</h5><ol>
<li>В настоящий момент общепринятым расширением для текстовых файлов формата TXT2GAM можно считать `.qsps`. "Просто потому что" (с) <a href="https://github.com/gretmn102/QSP-VSCode#допустим-я-хочу-попробовать" style="text-decoration:none;" class="emFOLD">Pseudopod</a>.</li>
<li>Существует утилита `qsp2txt` для конвертирования игр в обратную сторону — из файлов игр `.qsp` в текстовые файлы формата TXT2GAM. Исходная ссылка утеряна, можно скачать в <a href="https://mega.nz/folder/jXwXlSRJ#TF7P-soOJOWIC8MrBA-L1A" style="text-decoration:none;" class="emFOLD">архиве программ QSP от Aleks Versus</a>.</li>
<li>Существовали разные <a href="https://qsp.org/index.php?option=com_agora&task=topic&id=686&Itemid=57" style="text-decoration:none;" class="emFOLD">подсветки синтаксиса для `Notepad++` и `AkelPad`</a>, но были утеряны.</li>
<li>Подсветка синтаксиса для Sublime Text входит в <a href="https://github.com/AleksVersus/JAD_for_QSP" style="text-decoration:none;" class="emFOLD">пакет JAD на QSP для Sublime Text</a>.</li>
<li>Существует подсветка для <a href="https://qsp.org/components/com_agora/img/members/20/notepad-qsp.zip" style="text-decoration:none;" class="emFOLD">Notepad++ от Олегуса</a>. С этой подсветкой ассоциируются текстовые файлы с расширением `.tqsp`, однако вы можете отредактировать файл подсветки, указав нужное вам расширение.</li>
<li>Werewolf разработал утилиту для конвертирования QSP-файла в текстовый формат (аналог `qsp2txt`), которая работает онлайн: <a href="https://codepen.io/srg-kostyrko/full/QWqdwxv" style="text-decoration:none;" class="emFOLD">https://codepen.io/srg-kostyrko/full/QWqdwxv</a>. Так же он разработал специальные пакеты для конвертирования файлов в любую сторону: <a href="https://github.com/QSPFoundation/converters" style="text-decoration:none;" class="emFOLD">https://github.com/QSPFoundation/converters</a>.</li>
</ol>
<div style="display:flex;justify-content:space-between;"><div><a href="https://aleksversus.github.io/howdo_faq/informarch/avtomatnoe_programmirovanie_0009.html" class="emHREFTT">&lt; Назад, к странице 11</a></div><div><a href="https://aleksversus.github.io/howdo_faq/informarch/rabota_v_tekstovom_redaktore_0011.html" class="emHREFTT">Вперёд, к странице 13 &gt;</a></div></div>
<!-- body end -->
            <div class="em_Epigraph">
                <div class="em_subText">
                    <p>Aleks Versus'HowDo-F.A.Q.'2021-<span id="date_stamp_faq">2022</span></p>
                    <p>Aleks Versus'Game Adventure Making'Really Unimaginable Stories'2013-<span id="date_stamp_gamrus">2022</span></p>
                </div>
            </div>
            <div class="em_btn">
                <div>
                    <a href="https://aleksversus.github.io/howdo_faq/" class="emHREFTT">Главная</a>
                </div>
                <div>
                    <a href="#" class="emHREFTT" id="section_content_open">Содержание</a>
                </div>
            </div>
        </div>
        <div class="stub">
            &nbsp;
        </div>
    </div>
    <div id="soderzhanije_outer">
        <div class="soderzhanije">
<header-header></header-header>
        </div>
    </div>
    <script type="text/javascript" src="../res/js/text_replace.js"></script>
    <script type="text/javascript" src="../res/js/soderzhanie.js" ></script>
</body>
</html>
