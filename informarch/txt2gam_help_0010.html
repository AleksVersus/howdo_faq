<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <link id="favicon" rel="icon" type="image/x-icon" href="../res/favicon.ico" />
    <link type="text/css" rel="stylesheet" href="../res/css/easy.library.css" />
    <title>QSP: ИнформАрхив</title>
</head>
    
<body>
    <div class="avs-page-wrapper">
        <div class="easy-lib-page">
            <article class="e-block">
            <h1 class="avs-article-h1">ИнформАрхив QSP</h1>
            <!-- body start -->
<div class="avs-pages-button__wrapper"><div class="avs-pages-button__left-combine"><div class="avs-pages-button"><a href="https://aleksversus.github.io/howdo_faq/informarch/avtomatnoe_programmirovanie_0009.html" class="avs-pages-button__link">&lt; Назад, к странице 11</a></div></div><div class="avs-pages-button__right-combine"><div class="avs-pages-button"><a href="https://aleksversus.github.io/howdo_faq/informarch/rabota_v_tekstovom_redaktore_0011.html" class="avs-pages-button__link">Вперёд, к странице 13 &gt;</a></div></div></div>
<h5 id="informarch_txt2gam_manual" class="avs-article-h5">TXT2GAM. Краткое руководство</h5><p class="avs-article-p">
Утилита "TXT2GAM" ("txt2gam.exe") предназначена для конвертирования текстовых файлов, написанных в специальном формате, в файлы QSP-игр <code>.qsp</code>. Таким образом вы можете создавать игры в обычном текстовом редакторе, а затем конвертировать их в приемлемые для плееров файлы.
</p>
<p class="avs-article-p">
<a href="https://qsp.org/attachments/txt2gam011.zip" style="text-decoration:none;" class="avs-page-external-link">Скачать утилиту</a>
</p>
<h5 id="format-txt2gam" class="avs-article-h5">Формат TXT2GAM</h5><p class="avs-article-p">
Файлы в формате TXT2GAM — это обычные текстовые файлы, в которых мы размещаем код QSP, при этом данный код нужно записывать по определённым правилам.
</p>
<p class="avs-article-p">
Начало локации отмечается символом <code>#</code> (решётка/диез), после которого должен стоять пробел и название локации. Например так:
</p>
<div class="Monokai-Code">
<span class="Monokai-StartLoc">#&nbsp;начало</span><br/>
</div>
<p class="avs-article-p">
Конец локации обозначается символом <code>-</code> (дефис) в отдельной строке. После этого символа в той же строке могут идти любые символы, например, снова название локации:
</p>
<div class="Monokai-Code">
<span class="Monokai-Operator">-</span>&nbsp;начало<br/>
</div>
<p class="avs-article-p">
Между началом и концом локации записывается обычный код QSP, как если бы вы его писали в поле "Выполнить при посещении" редактора Quest Generator. Вот пример кода в формате TXT2GAM с двумя локациями:
</p>
<div class="Monokai-Code">
<span class="Monokai-StartLoc">#&nbsp;Начало</span><br/>
<span class="Monokai-String">'It'</span><span class="Monokai-String">'s&nbsp;only&nbsp;test&nbsp;of&nbsp;new&nbsp;utility.'</span><br/>
<span class="Monokai-String">'That&nbsp;is&nbsp;all.'</span><br/>
<span class="Monokai-Koperator">act</span>&nbsp;<span class="Monokai-String">'Далее'</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">goto</span>&nbsp;<span class="Monokai-String">'next'</span><br/>
<span class="Monokai-Koperator">end</span><span class="Monokai-EndLoc"><br/>
-&nbsp;(конец&nbsp;локации)</span><span class="Monokai-StartLoc"><br/>
<br/>
#&nbsp;next</span><br/>
$s<span class="Monokai-Operator">=</span><span class="Monokai-String">'Это&nbsp;последняя&nbsp;локация&nbsp;примера.'</span><br/>
i<span class="Monokai-Operator">=</span><span class="Monokai-Numeric">1</span><span class="Monokai-Markup"><br/>
:loop</span><br/>
<span class="Monokai-Koperator">if</span>&nbsp;i<span class="Monokai-Operator">&lt;=</span><span class="Monokai-Func">len</span><span class="Monokai-Operator">(</span>$s<span class="Monokai-Operator">)</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">*</span><span class="Monokai-Operator">p</span>&nbsp;<span class="Monokai-Func">$mid</span><span class="Monokai-Operator">(</span>$s<span class="Monokai-Operator">,</span>i<span class="Monokai-Operator">,</span><span class="Monokai-Numeric">1</span><span class="Monokai-Operator">)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">wait</span>&nbsp;<span class="Monokai-Numeric">200</span><br/>
&nbsp;&nbsp;&nbsp;i<span class="Monokai-Operator">=</span>i<span class="Monokai-Operator">+</span><span class="Monokai-Numeric">1</span><br/>
&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">jump</span>&nbsp;<span class="Monokai-String">'loop'</span><br/>
<span class="Monokai-Koperator">end</span><br/>
<span class="Monokai-Operator">*</span><span class="Monokai-Operator">nl</span>&nbsp;<span class="Monokai-Operator">&amp;</span>&nbsp;<span class="Monokai-String">'Это&nbsp;всё.'</span><span class="Monokai-EndLoc"><br/>
-</span><br/>
</div>
<p class="avs-article-p">
Между локациями в таком файле может быть записан любой текст, он не попадёт в конечный файл игры. Поэтому вы можете помещать туда различные комментарии, команды препроцессора и другой сопроводительный текст.
</p>
<p class="avs-article-p">
Поскольку концом локации считается символ <code>-</code> в начале отдельно стоящей строки, могут возникнуть ошибки, если вы напишете команду, наподобие этой:
</p>
<div class="Monokai-Code">
<span class="Monokai-Operator">-</span><span class="Monokai-Operator">(</span>x<span class="Monokai-Operator">+</span><span class="Monokai-Numeric">23</span><span class="Monokai-Operator">)</span><br/>
</div>
<p class="avs-article-p">
Записанная в поле "Выполнить при посещении" редактора Quest Generator данная команда будет нормально работать в итоговой игре, однако если эту команду записать в файле формата TXT2GAM, конвертер посчитает её окончанием локации, и все последующие за данной командой строки вплоть до начала следующей локации будут проигнорированы.
</p>
<div class="Monokai-Code">
<span class="Monokai-StartLoc">#&nbsp;начало</span><br/>
<span class="Monokai-String">"Какой-то&nbsp;код.&nbsp;Много-много&nbsp;кода<br/>
Этот&nbsp;код&nbsp;попадёт&nbsp;в&nbsp;локацию"</span><span class="Monokai-Operator"><br/>
</span><span class="Monokai-Comment">!&nbsp;пытаемся&nbsp;вывести&nbsp;произведение&nbsp;45&nbsp;и&nbsp;9&nbsp;умноженное&nbsp;на&nbsp;-1</span><span class="Monokai-EndLoc"><br/>
-(45*9)</span><br/>
<span class="Monokai-String">"А&nbsp;вот&nbsp;этот&nbsp;код&nbsp;не&nbsp;попадёт&nbsp;в&nbsp;локацию"</span><span class="Monokai-EndLoc"><br/>
-&nbsp;начало&nbsp;(хотим,&nbsp;чтобы&nbsp;конец&nbsp;локации&nbsp;был&nbsp;здесь)</span><br/>
Все&nbsp;строки&nbsp;от<span class="Monokai-EndLoc">&nbsp;-(45*9)&nbsp;будут&nbsp;проигнорированы</span><span class="Monokai-StartLoc"><br/>
<br/>
#&nbsp;локация&nbsp;2</span><span class="Monokai-Operator"><br/>
</span><span class="Monokai-Comment">!&nbsp;какой-то&nbsp;код</span><span class="Monokai-EndLoc"><br/>
-&nbsp;локация&nbsp;2</span><br/>
</div>
<p class="avs-article-p">
Если не закрыть локацию строкой начинающейся с <code>-</code>, новую локацию открыть будет нельзя, а значит строка, начинающаяся с символа <code>#</code> может вызвать ошибку "Неизвестное действие" в конечной игре:
</p>
<div class="Monokai-Code">
<span class="Monokai-StartLoc">#&nbsp;начало</span><br/>
<span class="Monokai-String">"Выводим&nbsp;текст"</span><span class="Monokai-StartLoc"><br/>
#&nbsp;локация&nbsp;2</span><br/>
<span class="Monokai-String">"Забыли&nbsp;закрыть&nbsp;локацию&nbsp;перед&nbsp;открытием&nbsp;новой"</span><span class="Monokai-EndLoc"><br/>
-&nbsp;локация&nbsp;2</span><br/>
</div>
<p class="avs-article-p">
Внимание! Для формата TXT2GAM не предусмотрено редактирование базового описания и базовых действий. Поэтому при экспорте игры из Quest Generator в формат TXT2GAM будьте внимательны: все базовые описания и базовые действия будут экспортированы в основной код локаций. Если впоследствии вы импортируете игру обратно из TXT2GAM-файла в Quest Generator, то поля "Описание" и "Базовые действия" во всех локациях окажутся пустыми.
</p>
<h5 id="ispol_zovanie-utility-txt2gam" class="avs-article-h5">Использование утилиты TXT2GAM</h5><p class="avs-article-p">
TXT2GAM — это консольная утилита, т.е. она запускается командами из консоли, например из командной строки Windows. Ознакомиться с основными командами командной строки вы можете в обучающей статье <a href="https://sonikelf.ru/vvodnaya-statya-po-rabote-v-konsoli-chto-takoe-konsol-komandy-konsoli-i-prochee-takoe-raznoe-cmd/" style="text-decoration:none;" class="avs-page-external-link">"Что такое консоль, команды и прочее такое разное — CMD"</a>.
</p>
<p class="avs-article-p">
Пример работы с утилитой:
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;game.txt&nbsp;game.qsp
</div>
<p class="avs-article-p">
Здесь: <code>game.txt</code> — исходный файл вашей игры, написанный в формате TXT2GAM; <code>game.qsp</code> — конечный файл, в котором будет сохранена ваша игра.
</p>
<p class="avs-article-p">
Предположим, вы написали игру в текстовом редакторе, и теперь она у вас лежит в виде файла <code>game.txt</code> на диске "<code>D:</code>" в папке "<code>QSP\Games\myCoolGame</code>".
</p>
<p class="avs-article-p">
Для удобства скопируйте утилиту TXT2GAM (т.е. файл <code>txt2gam.exe</code>) в папку с игрой. Теперь для конвертирования игры вам нужно сделать следующее:
</p>
<ol>
<li>Откройте консоль</li>
<li>Перейдите на диск "<code>D:</code>", введя команду <code>D:</code> в командной строке и нажав клавишу "Enter".</li>
<li>Перейдите в папку с вашей игрой с помощью команды <code>cd</code>. В нашем примере это делается так <code>cd "QSP\Games\myCoolGame"</code></li>
<li><p class="avs-article-p">
Запустите утилиту TXT2GAM, указав в качестве параметров сначала исходный файл вашей игры (т.е. <code>game.txt</code>), а затем название файла, который хотите получить, например <code>myCoolGame.qsp</code>:</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;game.txt&nbsp;myCoolGame.qsp
</div>
</li>
</ol>
<p class="avs-article-p">
Утилита поддерживает полные пути к файлам, поэтому вы можете использовать одну утилиту для конвертирования разных игр:
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;"D:\QSP\Games\myCoolGame\game.txt"&nbsp;"D:\QSP\releases\myCoolGame\myCoolGame.qsp"
</div>
<p class="avs-article-p">
Для получения дополнительной информации об утилите, запустите её в консоли без параметров:
</p>
<div class="Monokai-Code">
txt2gam.exe
</div>
<p class="avs-article-p">
Если указать ключ <code>u</code>, исходный файл будет обрабатываться как Unicode-файл (кодировка UCS-2 LE / UTF-16 LE):
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;game.txt&nbsp;myCoolGame.qsp&nbsp;u<br/>
</div>
<h5 id="dopolnitel_nye-vozmozhnosti-utility" class="avs-article-h5">Дополнительные возможности утилиты</h5><h5 id="ispol_zovanie" class="avs-article-h5">Использование</h5><p class="avs-article-p">
Общий вид команды для консоли:
</p>
<div class="Monokai-Code">
txt2gam&nbsp;[txt&nbsp;file]&nbsp;[output&nbsp;file]&nbsp;[options]
</div>
<h5 id="optsii-options" class="avs-article-h5">Опции. [Options]</h5><p class="avs-article-p">
a, A — режим ANSI. По-умолчанию утилита работает в режиме Unicode (UCS-2 / UTF-16).
</p>
<p class="avs-article-p">
u, U — режим Unicode (UCS-2 LE/ UTF-16 LE).
</p>
<p class="avs-article-p">
o, O — сохранить игру в старом формате (<code>.gam</code>). По умолчанию используется новый формат (<code>.qsp</code>).
</p>
<p class="avs-article-p">
s[char], S[char] — вместо [char] нужно указать символ, с которого начинаются ваши локации. Т.е. это символ, который вы можете использовать вместо <code>#</code>, если это необходимо.
</p>
<p class="avs-article-p">
e[char], E[char] — вместо [char] нужно указать символ, которым будет отмечаться конец локации. Т.е. это символ, который вы можете использовать вместо <code>-</code>, если это необходимо.
</p>
<p class="avs-article-p">
p[pass], P[pass] — вместо [pass] укажите пароль, который хотите установить на игру. По умолчанию <code>No</code>. Если пароль содержит пробелы, заключите его в кавычки.
</p>
<p class="avs-article-p">
t, T — извлечь строки из текста.
</p>
<p class="avs-article-p">
q, Q - извлечь q-строки из текста.
</p>
<h5 id="primery-vyzova" class="avs-article-h5">Примеры вызова:</h5><div class="Monokai-Code">
txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;pMyPassword
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;u
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;o&nbsp;pMyPassword
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;o&nbsp;e@&nbsp;pMyPassword
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;u&nbsp;o&nbsp;p"My&nbsp;Password"
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;o
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;o&nbsp;e@
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;s@&nbsp;e~
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;s@&nbsp;e~&nbsp;o
<br/>txt2gam.exe&nbsp;file.txt&nbsp;gamefile.qsp&nbsp;t&nbsp;u
</div>
<h5 id="podkliuchenie-utility-k-tekstovomu-redaktoru" class="avs-article-h5">Подключение утилиты к текстовому редактору</h5><p class="avs-article-p">
При разработке игр в текстовом редакторе, очень полезным может оказаться создание специального действия / кнопки для автоматической компиляции файла в <code>.qsp</code> и запуска плеера сразу с редактируемым файлом.
</p>
<p class="avs-article-p">
То есть пишете текст игры в редакторе, нажимаете некое сочетание клавиш и получаете запущенную в плеере игру.
</p>
<p class="avs-article-p">
Данное руководство, на примере <code><a href="http://www.emeditor.com" style="text-decoration:none;" class="avs-page-external-link">EmEditor</a></code>а , описывает, как это сделать.
</p>
<p class="avs-article-p">
Для начала, создайте папку (допустим, <code>D:\Games\QSP</code>), распаковав в неё базовый архив плеера (<code>qspgui.exe</code> + все <code>DLL</code>`ки) и архив утилиты TXT2GAM.
</p>
<p class="avs-article-p">
Далее, создайте в этой папке (рядом с <code>qspgui.exe</code>, <code>txt2gam.exe</code>) файл <code>start.bat</code> со следующим содержимым:
</p>
<div class="Monokai-Code">
txt2gam&nbsp;%1&nbsp;%2
<br/>start&nbsp;qspgui&nbsp;%2
</div>
<p class="avs-article-p">
Теперь нужно в редакторе добавить действие / кнопку, при нажатии на которую будет запущен файл <code>start.bat</code> с двумя аргументами - указанием исходного TXT файла и конечного <code>.qsp</code>-файла.
</p>
<ol>
<li>Запустите EmEditor, выберите в меню <code>Tools / External Tools / Customize Tools...</code></li>
<li>В появившемся окошке нажмите кнопку <code>New</code>.</li>
<li>В поле <code>Title</code> впишите название действия (например, "QSP").</li>
<li>В поле <code>Command</code> строку <code>D:\Games\QSP\start.bat</code></li>
<li>В поле <code>Arguments</code> строку <code>"$(Path)" "$(Dir)\$(Filename).gam"</code> (сохраняя кавычки)</li>
<li>В поле <code>Initial Directory</code> строчку <code>D:\Games\QSP</code></li>
<li>Затем поставьте флажок напротив <code>Save File</code>, и нажмите <code>OK</code>.</li>
<li>На панели инструментов появится новая кнопка с подписью "QSP", при нажатии на которую будут произведены требуемые действия.</li>
</ol>
<p class="avs-article-p">
Теперь нужно назначить сочетание клавиш для кнопки.
</p>
<ol>
<li>Выберите пункт меню <code>Help / Keyboard Map...</code>. В категории <code>External Tools</code> найдите пункт <code>QSP</code> (обычно, в самом низу) и щелкните по нему 2 раза.</li>
<li>Установите курсор в поле <code>Press New Shortcut Key</code> и нажмите желаемое сочетание клавиш (к примеру, F1). Станет доступной кнопка <code>Assign</code>. Нажимаем.</li>
<li>Далее жмём <code>OK</code> и пишем игры в формате TXT2GAM :-)</li>
</ol>
<p class="avs-article-p">
Чтобы установить пароль на файл, создаваемый утилитой TXT2GAM, замените в файле <code>start.bat</code> строчку
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;%1&nbsp;%2
</div>
<p class="avs-article-p">
на
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;%1&nbsp;%2&nbsp;pMyPassword
</div>
<p class="avs-article-p">
где <code>MyPassword</code> - устанавливаемый пароль. Для задания паролей с пробелами, строчка pMyPassword должна быть указана в кавычках:
</p>
<div class="Monokai-Code">
txt2gam.exe&nbsp;%1&nbsp;%2&nbsp;"pMy&nbsp;Pass&nbsp;word"
</div>
<h5 id="primechaniia" class="avs-article-h5">Примечания:</h5><ol>
<li>В настоящий момент общепринятым расширением для текстовых файлов формата TXT2GAM можно считать <code>.qsps</code>. "Просто потому что" (с) <a href="https://github.com/gretmn102/QSP-VSCode#допустим-я-хочу-попробовать" style="text-decoration:none;" class="avs-page-external-link">Pseudopod</a>.</li>
<li>Существует утилита <code>qsp2txt</code> для конвертирования игр в обратную сторону — из файлов игр <code>.qsp</code> в текстовые файлы формата TXT2GAM. Исходная ссылка утеряна, можно скачать в <a href="https://mega.nz/folder/jXwXlSRJ#TF7P-soOJOWIC8MrBA-L1A" style="text-decoration:none;" class="avs-page-external-link">архиве программ QSP от Aleks Versus</a>.</li>
<li>Существовали разные <a href="https://qsp.org/index.php?option=com_agora&amp;task=topic&amp;id=686&amp;Itemid=57" style="text-decoration:none;" class="avs-page-external-link">подсветки синтаксиса для <code>Notepad++</code> и <code>AkelPad</code></a>, но были утеряны.</li>
<li>Подсветка синтаксиса для Sublime Text входит в <a href="https://github.com/AleksVersus/JAD_for_QSP" style="text-decoration:none;" class="avs-page-external-link">пакет JAD на QSP для Sublime Text</a>.</li>
<li>Существует подсветка для <a href="https://qsp.org/components/com_agora/img/members/20/notepad-qsp.zip" style="text-decoration:none;" class="avs-page-external-link">Notepad++ от Олегуса</a>. С этой подсветкой ассоциируются текстовые файлы с расширением <code>.tqsp</code>, однако вы можете отредактировать файл подсветки, указав нужное вам расширение.</li>
<li>Werewolf разработал утилиту для конвертирования QSP-файла в текстовый формат (аналог <code>qsp2txt</code>), которая работает онлайн: <a href="https://codepen.io/srg-kostyrko/full/QWqdwxv" style="text-decoration:none;" class="avs-page-external-link">https://codepen.io/srg-kostyrko/full/QWqdwxv</a>. Так же он разработал специальные пакеты для конвертирования файлов в любую сторону: <a href="https://github.com/QSPFoundation/converters" style="text-decoration:none;" class="avs-page-external-link">https://github.com/QSPFoundation/converters</a>.</li>
</ol>
<div class="avs-pages-button__wrapper"><div class="avs-pages-button__left-combine"><div class="avs-pages-button"><a href="https://aleksversus.github.io/howdo_faq/informarch/avtomatnoe_programmirovanie_0009.html" class="avs-pages-button__link">&lt; Назад, к странице 11</a></div></div><div class="avs-pages-button__right-combine"><div class="avs-pages-button"><a href="https://aleksversus.github.io/howdo_faq/informarch/rabota_v_tekstovom_redaktore_0011.html" class="avs-pages-button__link">Вперёд, к странице 13 &gt;</a></div></div></div>
<!-- body end -->
            </article>
            <aside class="e-block">
                <div class="avs-page-stamp">
                    <p class="empty">Aleks Versus'HowDo-F.A.Q.'2021-<span class="subscribe-year">2022</span></p>
                    <p class="empty">Aleks Versus'Game Adventure Making'Really Unimaginable Stories'2013-<span class="subscribe-year">2022</span></p>
                </div>
            </aside>
            <aside class="em-btn">
                <div class="avs-pages-button__wrapper e-block">
                    <div class="avs-pages-button">
                        <a href="https://aleksversus.github.io/howdo_faq/" class="avs-pages-button__link">Главная</a>
                    </div>
                    <div class="avs-pages-button">
                        <a href="#"  class="avs-pages-button__link" id="section-content-open">Содержание</a>
                    </div>
                </div>
            </aside>
        </div><!-- easy-lib-page -->
    </div><!-- avs-page-wrapper -->
    <aside id="soderzhanije_outer">
        <div class="soderzhanije">
<header-header></header-header>
        </div>
    </aside>
    <script type="text/javascript" src="../res/js/text_replace.js"></script>
    <script type="text/javascript" src="../res/js/soderzhanie.js" ></script>
</body>
</html>
