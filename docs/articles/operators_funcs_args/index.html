<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-articles/operators_funcs_args/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.1">
<title data-rh="true">Операторы, функции, аргументы. GOSUB, FUNC, ARGS | Справочник | F.A.Q.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aleksversus.github.io/howdo_faq/res/favicon.ico"><meta data-rh="true" name="twitter:image" content="https://aleksversus.github.io/howdo_faq/res/favicon.ico"><meta data-rh="true" property="og:url" content="https://aleksversus.github.io/howdo_faq/docs/articles/operators_funcs_args/"><meta data-rh="true" property="og:locale" content="ru"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Операторы, функции, аргументы. GOSUB, FUNC, ARGS | Справочник | F.A.Q."><meta data-rh="true" name="description" content="Очень часто новички, пришедшие в QSP, задают вопрос: что такое ARGS, и как их использовать? И хотя информации по данному вопросу очень много, вся она довольно разрознена, отвечает на вопрос слишком общо, или слишком конкретно, вплоть до одного единственного примера."><meta data-rh="true" property="og:description" content="Очень часто новички, пришедшие в QSP, задают вопрос: что такое ARGS, и как их использовать? И хотя информации по данному вопросу очень много, вся она довольно разрознена, отвечает на вопрос слишком общо, или слишком конкретно, вплоть до одного единственного примера."><link data-rh="true" rel="icon" href="/howdo_faq/res/favicon.ico"><link data-rh="true" rel="canonical" href="https://aleksversus.github.io/howdo_faq/docs/articles/operators_funcs_args/"><link data-rh="true" rel="alternate" href="https://aleksversus.github.io/howdo_faq/docs/articles/operators_funcs_args/" hreflang="ru"><link data-rh="true" rel="alternate" href="https://aleksversus.github.io/howdo_faq/docs/articles/operators_funcs_args/" hreflang="x-default"><link rel="stylesheet" href="/howdo_faq/assets/css/styles.d9041b67.css">
<script src="/howdo_faq/assets/js/runtime~main.91ada92c.js" defer="defer"></script>
<script src="/howdo_faq/assets/js/main.689b0f83.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/howdo_faq/"><b class="navbar__title text--truncate">Главная</b></a><a class="navbar__item navbar__link" href="/howdo_faq/docs/howdo/intro">Как сделать? F.A.Q.</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/howdo_faq/docs/articles/type_casting">Статьи</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/howdo_faq/docs/informarch/intro">Информ-Архив</a><a href="https://aleksversus.github.io/howdo_faq/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub/HowDo_F.A.Q<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-label="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/articles/type_casting">Преобразование типов в QSP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/articles/arrays_580/">Массивы уже не те</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/articles/news_580">Что нового в QSP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/articles/qspider_0120/">qSpider версии 0.12.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/articles/config_classic_570">Структура конфигурационного файла классического плеера версии 5.7.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/howdo_faq/docs/articles/operators_funcs_args/">Операторы, функции, аргументы. GOSUB, FUNC, ARGS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/articles/stylization_manifest">Манифест об организации кода в QSP</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Главная страница" class="breadcrumbs__link" href="/howdo_faq/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Операторы, функции, аргументы. GOSUB, FUNC, ARGS</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><header><h1>Операторы, функции, аргументы. GOSUB, FUNC, ARGS</h1></header>
<p>Очень часто новички, пришедшие в QSP, задают вопрос: что такое ARGS, и как их использовать? И хотя информации по данному вопросу очень много, вся она довольно разрознена, отвечает на вопрос слишком общо, или слишком конкретно, вплоть до одного единственного примера.</p>
<p>Эта статья является попыткой ответить на данный вопрос максимально просто, точно и подробно, насколько это в принципе будет возможно.</p>
<p><img decoding="async" loading="lazy" alt="qsp.png" src="/howdo_faq/assets/images/QSP-10e87da2a0dfd2b2a76bab057475571d.png" width="1004" height="753" class="img_ev3q"></p>
<p>Все примеры рекомендую испытать самостоятельно, побаловаться, изменяя значения, и посмотреть, что из этого выйдет. Теория без практики — мертва.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Обратите внимание.</div><div class="admonitionContent_BuS1"><p>В статье приведены фрагменты кода QSP, некоторые из которых написаны в формате TXT2GAM. Такие фрагменты легко отличить, так как в них отдельными строками прописывается начало локации (<code># start</code>) и её конец (<code>--- start ---</code>). Если вы работаете в редакторе Quest Generator, данные строчки прописывать в коде локаций не нужно, только содержимое между ними.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="пробуем-воду-немного-определений">Пробуем воду. Немного определений<a href="#пробуем-воду-немного-определений" class="hash-link" aria-label="Прямая ссылка на Пробуем воду. Немного определений" title="Прямая ссылка на Пробуем воду. Немного определений">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="операторы">Операторы<a href="#операторы" class="hash-link" aria-label="Прямая ссылка на Операторы" title="Прямая ссылка на Операторы">​</a></h3>
<p>При написании QSP-кода мы всегда используем различные операторы. Например, мы используем оператор <code>*pl</code> для вывода текста в окно основного описания, или оператор <code>addobj</code> для добавления предмета, или например оператор <code>goto</code> для перехода между локациями. Иными словами операторы нужны нам, чтобы что-то <code>делать</code> с игрой или с плеером, выполнять какие-то процедуры.</p>
<p>Если мы внимательно посмотрим на все эти операторы, то мы увидим, что для некоторых операторов, чтобы они что-то сделали, нужно обязательно указать какое-то значение. Например, чтобы оператор <code>addobj</code> добавил предмет в окно предметов, мы должны указать название предмета для этого оператора:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Апельсин&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="%image%" src="/howdo_faq/assets/images/XCyNJqv-c75f9eb5d43bf826e72c80bf9fd84f33.png" width="1600" height="726" class="img_ev3q"></p>
<p>Такое указание значения в программировании называется <code>передачей значения</code> оператору. Оператор принимает от нас указанное значение и что-то с ним делает. Например, создаёт предмет с указанным названием. Само значение, которое мы передаём оператору, нередко называют <code>аргументом</code> или <code>параметром</code>.</p>
<p>Поэтому если вы встречаете где-то такое выражение &quot;передаю параметры оператору&quot;, или &quot;указываю аргументы для оператора&quot;, это значит, что оператору передаются какие-то значения, которые он принимает и обрабатывает.</p>
<p>В случае с оператором <code>addobj</code> мы должны обязательно указать хотя бы один аргумент, но в QSP есть операторы, для которых можно совсем не указывать аргументы. Например, оператору <code>clear</code>, который очищает окно дополнительного описания, не нужны аргументы, он и так знает, что ему делать. Или оператор <code>killall</code>, ему тоже не нужен аргумент. Ещё, совсем без аргумента, может использоваться оператор <code>*pl</code>, тогда он просто выводит на экран пустую строку и совершает переход на новую строку в окне основного описания.</p>
<p>Некоторым операторам можно передавать больше одного аргумента. Если взглянуть на тот же оператор <code>addobj</code>, мы можем передавать ему и два и три аргум ента:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Апельсин&quot;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&quot;pic/orange.png&quot;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>В данном случае мы передаём оператору три аргумента: название предмета, картинку предмета, и позицию в окне предметов, в которую мы данный предмет хотим поместить. Аргументы перечисляются через запятую.</p>
<p>В зависимости от числа принимаемых аргументов, операторы могут вести себя по-разному:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">killvar</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! два аргумента. Удаляем ячейку номер 4 из массива $mass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">killvar</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$array&#x27;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! один аргумент. Удаляем весь массив $array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">killvar</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! без аргументов. Удаляет все массивы и переменные в игре</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Нужно помнить, сколько аргументов ожидает получить каждый оператор. Операторы типа <code>clear</code> и <code>killall</code> вообще не ждут аргументов, поэтому передавать им какие-либо значения бесполезно. Оперторы типа <code>addobj</code>, <code>goto</code> и <code>act</code> ждут хотя бы один аргумент, но могут принимать больше. Если передать оператору больше аргументов, чем он может принять, или меньше, чем он ожидает, это приведёт к ошибке №120: &quot;Неверное число аргументов оператора/функции&quot;, — поэтому будьте внимательны при написании кода и чаще сверяйтесь со справкой.</p>
<p><img decoding="async" loading="lazy" alt="%image%" src="/howdo_faq/assets/images/R6WQKpb-4f0900441d2f5e23498ecf46e57545cf.png" width="1174" height="807" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="функции">Функции<a href="#функции" class="hash-link" aria-label="Прямая ссылка на Функции" title="Прямая ссылка на Функции">​</a></h3>
<p>Помимо операторов в QSP есть ещё такие вещи, как <code>функции</code>. Функции тоже могут что-нибудь делать с игрой или плеером, но в основном они нужны, чтобы получать какие-либо значения.</p>
<p>Например, с помощью функции <code>rnd</code> мы можем получить случайное число от 1 до 1000:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">num</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">rnd</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! в переменную num запишется случайное число от 1 до 1000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>В этом и заключается основное отличие функции от оператора, функция умеет <code>возвращать значение</code>. Значение, возвращаемое функцией, ещё называют <code>результатом</code>, поэтому можно сказать, что <code>функция возвращает результат</code>.</p>
<p><img decoding="async" loading="lazy" alt="%image%" src="/howdo_faq/assets/images/tbwMRvc-4798344d75d3f8a326b922c805e865c5.png" width="1093" height="826" class="img_ev3q"></p>
<p>Точно так же, как оператор, функция может принимать аргументы, однако аргументы, которые мы хотим передать функции, нужно заключать в круглые скобки, в отличие от операторов, которым такие скобки не нужны.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">num</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">rand</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">1000</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! аргументы функции rand заключены в скобки</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">killvar</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">9</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! аргументы оператора killvar не нужно заключать в скобки</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Таким образом функция <code>принимает аргументы</code> и <code>возвращает результат</code>. Или <code>получает параметры</code> и <code>возвращает значение</code>. Говорите, как вам удобнее, главное, чтобы вы понимали, что все эти слова значат.</p>
<p>В QSP есть много разных функций, и так же, как и операторам, им можно передавать разное число аргументов. Есть функции, которым вообще не нужно передавать никаких аргументов, например <code>$selact</code>, <code>$curact</code>, <code>$curloc</code> и т.д. А есть функции, которые требуют строго определённого числа аргументов, например <code>isnum</code>, которая ожидает всегда только один аргумент, не больше, не меньше. Ну и конечно же есть функции, которым можно передавать разное число аргументов, и чьё поведение будет меняться в зависимости от числа аргументов:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin">max</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;mass&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! передан один строковый аргумент. Функция вернёт максимальное число из массива mass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">max</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;gass&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;dass&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! передано три строковых аргумента. Функция вернёт тот из них, который идёт позже в алфавитном порядке</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">max</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">12</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! данная строчка кода вызовет ошибку 114</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">max</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">12</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">34</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! функция вернёт наибольшее из двух чисел (34)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="%image%" src="/howdo_faq/assets/images/CHdzh7k-1d5a1af2c471e6000295849a4a89f005.png" width="1600" height="656" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="плаваем-у-берега-пользовательские-функции-и-процедуры">Плаваем у берега. Пользовательские функции и процедуры<a href="#плаваем-у-берега-пользовательские-функции-и-процедуры" class="hash-link" aria-label="Пряма я ссылка на Плаваем у берега. Пользовательские функции и процедуры" title="Прямая ссылка на Плаваем у берега. Пользовательские функции и процедуры">​</a></h2>
<p>Как быть, когда нам не хватает функционала уже имеющихся в QSP функций и операторов? Что если нам нужно, например, постоянно выводить на экран значения некоторых переменных, причём не просто выводить, а выводить эти значения внутри определённой строки. Например, у нас есть вот такой набор переменных:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">$name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Леголас&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">age</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">137</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$arms</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Лук и стрелы&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>И мы хотим периодически видеть на экране что-то вроде:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Вас зовут Леголас.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вам 137 лет.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вы используете Лук и стрелы.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Для этой ситуации в QSP предусмотрено создание собственных аналогов функций и операторов. Для этого мы должны создать отдельную локацию и написать на ней нужный код. В нашем случае локация будет называться &quot;pl_stat&quot;:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! # pl_stat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вас зовут &lt;&lt;$name&gt;&gt;.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вам &lt;&lt;age&gt;&gt; лет.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вы используете &lt;&lt;$arms&gt;&gt;.&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>И теперь, когда у нас есть такая локация, нам достаточно вызвать её с помощью оператора <code>gosub</code> в любом месте нашей игры, и мы увидим на экране нужный текст со вставленной информацией из наших переменных.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pl_stat&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Оч евидно, что работа данной локации стала похожа на работу некоей расширенной версии оператора <code>*pl</code>.</p>
<p>Что же дальше? А дальше нам хотелось бы написать какой-нибудь аналог функции, например, чтобы посчитать квадрат числа N. И мы можем это сделать. Создадим локацию &quot;square&quot; и на ней напишем следующий код:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! # square</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">R</span><span class="token operator" style="color:#393A34">=</span><span class="token user-variable">N</span><span class="token operator" style="color:#393A34">*</span><span class="token user-variable">N</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Вот такой простой код. Если мы вызовем данную локацию с помощью <code>func</code>, то в переменную R у нас запишется результат возведения в квадрат числа N.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">N</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;square&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">R</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экране появится число 144</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Однако с таким же успехом мы можем вызывать данную локацию через <code>gosub</code>, ведь результат вычислений всё равно пишется в переменную R прямо на локации &quot;square&quot;. Зачем нам здесь использовать <code>func</code>? Действительно незачем. Сейчас наша локация просто вычисляет значение и записывает его в переменную, однако мы можем заставить её <code>возвращать значение</code>! То есть она будет работать почти как полноценная функция QSP.</p>
<p>Чтобы заставить нашу локацию возвращать значение, мы должны результат вычислений записать в специальную системную переменную <code>result</code>.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! # square</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token user-variable">N</span><span class="token operator" style="color:#393A34">*</span><span class="token user-variable">N</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Теперь наша локация будет возвращать нам значение аналогично любой встроенной в QSP функции. А значит мы можем присвоить значение переменной уже в той локации, из которой вызвали локацию &quot;square&quot;:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">N</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">R</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;square&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">R</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экране появится число 144</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Или вообще не использовать промежуточную переменную:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">N</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;square&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экране появится число 144</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Уникальность переменной <code>result</code> заключается в том, что она действительно уникальная на каждой локации, из которой мы её вызываем. То есть, если мы на локации &quot;start&quot; (для примера) записали в переменную <code>result</code> какое-либо значение, то, если мы вызовем из локации &quot;start&quot; локацию &quot;square&quot;, где мы тоже используем <code>result</code>, на локации &quot;start&quot; значение в переменной <code>result</code> не изменится. Это легко проверить:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! записываем число в переменную result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">N</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;square&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран 576</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">result</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран 123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- start -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># square</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token user-variable">N</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token user-variable">N</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- square -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>И всё-таки наш код не такой удобный, как бы нам хотелось, ведь функциям QSP мы просто передаём аргументы, и не заполняем заранее разные переменные перед тем, как вызвать ту или иную функцию. Что же делать?</p>
<p>А всё очень просто. Разработчик QSP предусмотрел такую необходимость, и мы можем передавать нашей локации до девяти аргументов (в плеере версии 5.7.0). Просто берём и внутри круглых скобок ставим запятую после названия нашей локации &quot;square&quot; и указываем значение, которое хотим передать локации:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;square&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">25</span><span class="token sign-punctuation">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Вот и всё. На локацию &quot;square&quot; передан <code>параметр</code>, или иными словами локация &quot;square&quot; <code>получила в качестве аргуме нта</code> значение <code>25</code>. Но как же это значение использовать на локации &quot;square&quot;, ведь теперь мы не вносили его ни в одну переменную. А вся хитрость в том, что данное значение плеер сам автоматически вносит в специальный системный массив <code>args</code>. В данном случае число <code>25</code> нужно искать в нулевой ячейке этого массива на локации &quot;square&quot;.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! # square</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран число, которое мы отправляем на эту локацию</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">*</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! вместо N мы теперь используем число из нулевой ячейки массива args</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Попробуйте запустить код из предыдущего примера, но теперь без переменной N:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! записываем число в переменную result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;square&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">24</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран 576</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">result</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран 123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- start -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># square</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! поскольку выше мы передаём на square число 24, то эта команда выведет на экран число 24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">*</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- square -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Итак, мы знаем, что можем передавать на нашу локацию-фу нкцию до девяти аргументов. Мы нашли, где искать аргумент, если он один. А где же искать все остальные? Всё очень просто. Каждый последующий аргумент будет автоматически помещаться в следующую ячейку массива args. Таким образом, если мы передадим на локацию все девять аргументов, мы сможем их найти в массиве args, в ячейках с нулевой по восьмую.</p>
<p>Давайте напишем функцию, которая будет складывать девять чисел, передаваемых ей в качестве аргументов. Для этого создаём локацию &quot;summ&quot;:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! # summ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">5</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">6</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">7</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">8</span><span class="token sign-punctuation">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>А вот примеры вызова этой локации &quot;summ&quot;. Мы передаём на эту локацию девять слагаемых, а она возвращает нам сумму всех девяти слагаемых:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;summ&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">5</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">6</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">7</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">8</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">9</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экране появится число 45</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;summ&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">23</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">45</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">67</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">89</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">11</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">23</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">5</span><span class="token sign-punctuation">,</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экране появится число 262</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Если мы укажем не все аргументы, значения несуществующих ячеек массива <code>args</code> на локации &quot;summ&quot; окажутся равны нулю:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;summ&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экране появится число 10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;summ&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">23</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">45</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">67</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экране появится число 135</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>С массивом <code>args</code> можно работать, как с обычным массивом QSP. Т.е. вы легко можете добавлять в него новые ячейки, или удалять с помощью <code>killvar</code>. Однако у этого массива есть одна особенность, которая роднит его с переменной <code>result</code>. Для каждой отдельной локации массив <code>args</code> уникален. То есть вы можете помещать в не го любые значения, увеличивать или уменьшать его размер, это никак не повлияет на массив <code>args</code> в других локациях.</p>
<p>Более того. После того, как код локации, на которой вы работали с массивом <code>args</code>, будет выполнен, этот уникальный массив будет полностью уничтожен, а значит он уже не будет занимать место в оперативной памяти. Но, надо понимать, что в других работающих локациях свои собственные массивы <code>args</code> продолжат существовать.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! данный код выведет на экран последовательно числа 11, 1507, 19</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">19</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! это нулевая ячейка массива args на локации start, ей присваиваем 19</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">11</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран 1507</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран 19</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- start -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># foo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! на локации foo собственный уникальный массив args,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! в который автоматически записываются значения, переданные на локацию в виде аргументов</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выше сюда было передано число 11, вот его мы и увидим на экране</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">137</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- foo -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Давайте вернёмся к локации &quot;pl_stat&quot;, она, как вы помните, выводила на экран значения определённых переменных. Теперь мы можем переписать и её, чтобы она работала не с конкретными переменными, а с аргументами, которые мы на эту локацию передаём.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! # pl_stat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вас зовут &lt;&lt;$args[0]&gt;&gt;.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вам &lt;&lt;args[1]&gt;&gt; лет.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вы используете &lt;&lt;$args[2]&gt;&gt;.&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Как видите, мы подставляем в строки данные из <code>$args[0]</code>, <code>args[1]</code> и <code>$args[2]</code>, где соответсвенно мы должны найти имя, возраст и оружие персонажа. Значит и передавать на &quot;pl_stat&quot; аргументы мы должны в той же последовательности:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">$name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Леголас&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">age</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">137</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$arms</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Лук и стрелы&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! вызов локации `pl_stat`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pl_stat&quot;</span><span class="token sign-punctuation">,</span><span class="token user-variable">$name</span><span class="token sign-punctuation">,</span><span class="token user-variable">age</span><span class="token sign-punctuation">,</span><span class="token user-variable">$arms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Это даст на экране всё тот же текст:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Вас зовут Леголас.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вам 137 лет.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вы используете Лук и стрелы.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Само собой, если нет необходимости, заранее объявлять переменные не обязательно:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pl_stat&quot;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Леголас&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">137</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Лук и стрелы&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>И теперь, один раз написанная локация позволяет нам выводить текст с нужными вставками сколько угодно раз:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pl_stat&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Гимли&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">91</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Молот&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pl_stat&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Арагорн&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">29</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Палаш&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pl_stat&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Фродо Бэггинс&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">19</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Кольцо Всевластия&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Вот результат таких вызовов:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Вас зовут Гимли.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вам 91 лет.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вы используете Молот.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вас зовут Арагорн.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вам 29 лет.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вы используете палаш.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вас зовут Фродо Бэггинс.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вам 19 лет.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Вы используете Кольцо Всевластия.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Объявить переменную</strong> — для QSP значит записать в программе её имя. Когда мы присваиваем переменной какое-либо значение, мы тем самым автоматически объявляем переменную. Ещё это называется <em>инициализировать</em> переменную.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="глубокое-погружение-тонкости-и-нюансы-при-написании-собственных-функций-и-процедур">Глубокое погружение. Тонкости и нюансы при написании собственных функций и процедур<a href="#глубокое-погружение-тонкости-и-нюансы-при-написании-собственных-функций-и-процедур" class="hash-link" aria-label="Прямая ссылка на Глубокое погружение. Тонкости и нюансы при написании собственных функций и процедур" title="Прямая ссылка на Глубокое погружение. Тонкости и нюансы при написании собственных функций и процедур">​</a></h2>
<p>Когда мы писали локации типа &quot;square&quot; и &quot;summ&quot;, для удобства мы называли их функциями. И ещё мы говорили, что передаём им различные аргументы. Так мы говорили именно для упрощения понимания того, зачем нам нужны <code>args</code> и <code>result</code> на локациях.</p>
<p>На самом деле ни одна локация в QSP фактически не является функцией, несмотря на то, что мы действительно передаём на неё аргументы, и можем вернуть из неё некий результат.</p>
<p>Функцией является только функция <code>func</code>, и как не сложно догадаться, эта функция всегда ждёт минимум один аргумент — название локации, которую она должна выполнить. Именно функция <code>func</code> выполняет код указанной локации, и именно она транслирует на эту локацию в массив <code>args</code> все прочие аргументы, &quot;передаваемые на локацию&quot;.</p>
<p>То же самое касается и оператора <code>gosub</code>. Этот оператор вызвает указанную в качестве первого для него аргумента локацию, и транслирует все остальные аргументы в массив <code>args</code> на этой локации.</p>
<p>Всё это следует понимать, потому что не только оператор <code>gosub</code> и функция <code>func</code> могут принимать дополнительные аргументы и транслировать их в код вашей локации в виде значений в массиве <code>args</code>. На это способны так же операторы <code>goto</code> и <code>xgoto</code>. Да, представьте себе. При переходе на новую локацию с помощью <code>goto</code> вы можете сразу передать на эту локацию разные данные с предыдущей локации. Например, так вы можете отслеживать, с какой именно локации на текущую был осуществлён переход.</p>
<p>В качестве примера привожу код локации &quot;start&quot;, на которой реализовано действие перехода с передачей аргумента, и код локации &quot;комната&quot;, где в зависимости от того, какое значение мы отправили на эту локацию, выводится разный текст:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;Начало супер-пупер-мега игры&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Начать&quot;</span><span class="token label">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;комната&quot;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&quot;start&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- start -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># комната</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;start&#x27;</span><span class="token label">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;История начинается. Вы только что пришли с локации &#x27;start&#x27;, и это означает, что вас ждёт душещипательная катсцена.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">else</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Вы пришли с любой другой локации. Это просто комната.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- комната -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Но и это ещё не всё. Можно передавать аргументы не только в код локаций, но и в код, который выполняется с помощью <code>dynamic</code> или <code>dyneval</code>.</p>
<p>Для примера я напишу код, который будет выводить содержимое всех переданных аргументов, с помощью цикла:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">! помещаем код в переменную для удобства</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">$code = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">    i=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">    :for</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">    if i&lt;arrsize(&#x27;args&#x27;):</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">        if $args[i]&lt;&gt;&#x27;&#x27;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">            *pl $args[i]</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">        else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">            *pl args[i]</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">        i+=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">        jump &#x27;for&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">    killvar &#x27;i&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token braced-comment comment" style="color:#999988;font-style:italic">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! выполняем код, передавая ему произвольное число аргументов</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">dynamic</span><span class="token plain"> </span><span class="token user-variable">$code</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Апельсин&#x27;</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;оранжевый&#x27;</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">144</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>На примере кода, помещённого в переменную, видно, что мы работаем с <code>args</code>, как с обычными массивом. Т.е. мы можем получить его размер, и обойти все ячейки поочерёдно с помощью цикла. Но значения в массив <code>args</code> помещаются автоматически в момент передачи аргументов оператору <code>dynamic</code>. Для этого оператора первым и обязательным аргументом является код QSP, записанный в виде строки текста. Все остальные аргументы не обязательны и транслируются в массив <code>args</code>, который мы можем использовать уже непосредственно внутри написанного нами кода.</p>
<p>Поскольку <code>dynamic</code> — это оператор, он не может возвращать нам никаких значений. Чтобы иметь возможность получать значение из написанного таким образом кода, мы до лжны использовать функцию <code>dyneval</code>. И тут действуют те же принципы, что и при написании кода для локаций. Чтобы функция вернула нам значение, мы должны это значение присвоить системной переменной <code>result</code>.</p>
<p>С помощью <code>dyneval</code> напишем функцию, которая возводит число в степень. Прежде всего мы должны представить себе, как будет выглядеть вызов такой функции. Саму функцию мы поместим в переменную <code>$pow</code>, и будем пердавать в неё два аргумента: само число и степень, в которую мы хотим это число возвести. То есть вызов нашей функции будет выглядеть так:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">dyneval</span><span class="token sign-punctuation">(</span><span class="token user-variable">$pow</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! возводим число 3 в четвёртую степень</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Таким образом в коде функции мы будем использовать два аргумента, значения которых можно получить из массива <code>args</code>:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">$pow</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token sign-punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    ! args[0] — число, которое хотим возвести в степень</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    ! args[1] — степень, в которую хотим возвести число</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! сразу присваиваем результату единицу</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    ! теперь с помощью цикла умножаем результат на указанное число</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    ! столько раз, каково значение степени.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    ! т.е. само значение степени у нас будет счётчиком цикла</span><span class="token label"></span><br></span><span class="token-line" style="color:#393A34"><span class="token label">    :for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">*</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">-=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">jump</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;for&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sign-punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Нам осталось только протестировать работу функции, чтобы проверить результаты:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">dyneval</span><span class="token sign-punctuation">(</span><span class="token user-variable">$pow</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет число 81</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">dyneval</span><span class="token sign-punctuation">(</span><span class="token user-variable">$pow</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет число 64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">dyneval</span><span class="token sign-punctuation">(</span><span class="token user-variable">$pow</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">9</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">9</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет число 387420489</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>И снова обращаю ваше внимание, что называю содержимое переменной <code>$pow</code> функцией исключительно для удобства. На самом деле функцией здесь является <code>dyneval</code>, именно она принимает все аргументы, в том числе и код, записанный в переменную <code>$pow</code> (именно поэтому в круглые скобки мы заключаем и значение переменной <code>$pow</code> и все последующие аргументы), а затем выполняет этот код, передавая на него все оставшиеся значения аргументов. Эти значения мы затем можем использовать в коде, благодаря тому, что они автоматически записываются в массив <code>args</code> в ячейки, начиная с нулевой. И именно <code>dyneval</code> забирает из переменной <code>result</code> значение и возвращает его нам.</p>
<p>И точно так же, как это происходило на локациях, можно увидеть, что в коде, который мы передаём оператору <code>dynamic</code>, или функции <code>dyneval</code>, создаётся свой собственный уникальный массив <code>args</code> и своя собственная уникальная переменная <code>result</code>, которые уничтожаются сразу после выполнения кода.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">$result</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Первый&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$code</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;if args[0]=2: $result=&#x27;Второй&#x27; else $result=&#x27;Никакой&#x27;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">$dyneval</span><span class="token sign-punctuation">(</span><span class="token user-variable">$code</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">)</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран строку `Второй` </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран число 123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">$result</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет на экран строку `Первый` </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>В программировании такие переменные и массивы, как <code>args</code> и <code>result</code> называются локальными. То есть они действительны только для определённого блока кода, а после выполнения этого блока кода уничтожаются.</p>
<p>В нашем случае отдельным блоком кода можно считать локацию или код, который мы передаём оператору <code>dynamic</code> или функции <code>dyneval</code>. А ещё код, который выполняется при нажатии на гиперссылку.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token sys-variable">usehtml</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">137</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;a href=&#x27;exec:args[0]=37 &amp; *pl args[0] &amp; ! в гиперссылке собственные args&#x27;&gt;Нажми, чтобы вывести 37&lt;/a&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;a href=&#x27;exec:*pl args[0] &amp; ! в гиперссылке собственные args&#x27;&gt;Нажми, чтобы вывести 0&lt;/a&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экран выведется 137</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Отдельными блоками кода можно считать так же код действия. Однако для этих блоков кода не создаются свои собственные <code>args</code>. В них транслируются значения <code>args</code> из того уже запущенного блока кода, который их вызывает. Для примера можно посмотреть, как изменяется значение <code>args</code> на локации с помощь ю действий.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">111</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выставляем значение args[0] на локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Действие 1&quot;</span><span class="token label">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Старое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">222</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! изменяем значение args[0] не только в действии, а сразу на локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Новое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Действие 2&quot;</span><span class="token label">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Старое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">333</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! изменяем значение args[0] не только в действии, а сразу на локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Новое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>В дальнейшем я буду говорить только про локации и действия, но следует помнить, что всё, что справедливо для кода локаций, справедливо так же и для кода, передаваемого оператору <code>dynamic</code> или функции <code>dyneval</code>, а так же для кода в гиперссылке. И ровно так же то, что справедливо для действий, справедливо для циклов в QSP версии 5.8.0.</p>
<p>Поскольку на каждой локации создаётся свой собственный, локальный массив <code>args</code>, этот массив можно использовать для замены любых необходимых локальных переменных.</p>
<p>В качестве примера приведу код локации &quot;#chk.obj.word#&quot; из моей библиотечки <a href="https://github.com/AleksVersus/easy.math" target="_blank" rel="noopener noreferrer">easy.math</a>, которая ищет в списке предметов предмет, содержащий в названии указанное слово. Функция принимает в качестве аргумента это самое слово, а затем возвращает позицию предмета в списке предметов:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! # #chk.obj.word#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">9</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">9</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! инициализируем девятый элемент массива, чтоб не затереть аргументы</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&#x27;i&#x27;</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! используем одну из  ячеек массива args как локальную переменную</span><span class="token label"></span><br></span><span class="token-line" style="color:#393A34"><span class="token label">:loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">no</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&#x27;i&#x27;</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">countobj</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    !@ цикл выполняется пока счётчик не превысит число предметов</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">instr</span><span class="token sign-punctuation">(</span><span class="token builtin">$getobj</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&#x27;i&#x27;</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token sign-punctuation">,</span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        !@ как только в названии очередного предмета</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        !@ встречается рассматриваемое слово</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token sys-variable">result</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&#x27;i&#x27;</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; !@ возвращаем позицию</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">exit</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; !@ закрываем функцию</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&#x27;i&#x27;</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">jump</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;loop&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Вот пример работы данной функции:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Красный помидор&quot;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! первый предмет</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Рыжий апельсин&quot;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! второй предмет</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Зелёное яблоко&quot;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! третий предмет</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Синий крокодил&quot;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! четвёртый предмет</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! ищем предмет, название которого содержит слово `Зелён`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">pos</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;#chk.obj.word#&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Зелён&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! можно вывести и позицию и название</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Мы нашли предмет под номером &lt;&lt;pos&gt;&gt;. Это &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$getobj</span><span class="token sign-punctuation">(</span><span class="token user-variable">pos</span><span class="token sign-punctuation">)</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&quot;.&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Используя массив <code>args</code> не только для получения переданных на локацию аргументов, но и в качестве локальных переменных, вы избавляетесь от необходимости следить, не забыли ли вы удалить какие-то промежуточные данные, которые вам требовались для вычислений исключительно на одной локации, исключительно в отдельном блоке кода. Плеер сам уничтожит массив <code>args</code>, когда код будет выполнен.</p>
<p>Если вы до сих пор пишете игру для плеера версии 5.7.0, вы просто вынуждены использовать массив <code>args</code> вместо локальных переменных, либо вы вынуждены уничтожать переменные и массивы, используемые для временного хранения данных, вручную с помощью <code>killvar</code>. Всё изменилось с появлением плееров версии 5.8.0!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="бездна-смотрит-в-тебя-локальные-переменные-и-неявный-вызов-пользовательских-функций">Бездна смотрит в тебя. Локальные переменные и неявный вызов пользовательских функций<a href="#бездна-смотрит-в-тебя-локальные-переменные-и-неявный-вызов-пользовательских-функций" class="hash-link" aria-label="Прямая ссылка на Бездна смотрит в тебя. Локальные переменные и неявный вызов пользовательских функций" title="Прямая ссылка на Бездна смотрит в тебя. Локальные переменные и неявный вызов пользовательских функций">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="локальные-переменные">Локальные переменные<a href="#локальные-переменные" class="hash-link" aria-label="Прямая ссылка на Локальные переменные" title="Прямая ссылка на Локальные переменные">​</a></h3>
<p>В плеерах версии 5.8.0 и выше появилась возможность объявить любую переменную локальной, т.е. значения данной переменной будут действительны только для отдельного блока кода, а после выполнения этого блока кода все переменные, объявленные для него локальными, будут уничтожены. Для примера возьмём две локации: локацию &quot;start&quot; и локацию &quot;foo&quot;:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! этот код последовательно выведет на экран числа 12, 549 и 99, 549</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">x</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">99</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">z</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4608</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">x</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">z</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экран выведутся числа 99 и 549</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- start -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># foo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token declarator">local</span><span class="token plain"> </span><span class="token user-variable">x</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! объявляем переменную x локальной для данной локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">x</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! изменяем значение переменной x</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">z</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">549</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">x</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">z</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! на экран выведутся числа 12 и 549</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- foo -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Если запустите этот код, то увидите, что значение, присвоенное переменной <code>x</code>, на локации &quot;start&quot; до вызова локации &quot;foo&quot;, сохраняется и после вызова локации &quot;foo&quot;, так как на локации &quot;foo&quot; мы объявили собственную уникальную переменную <code>x</code>. А вот переменную <code>z</code> мы не объявляли локальной на локации &quot;foo&quot;, а значит, если  мы меняем её значение на локации &quot;foo&quot;, то оно меняется для всех локаций. Что мы и видим.</p>
<p>По своему поведению локальные переменные несколько отличаются от <code>args</code> и <code>result</code>. Дело в том, что <code>args</code> и <code>result</code> объявляются на каждой локации автоматически, и мы можем быть уверены, что всегда будем работать на каждой отдельной локации с уникальными (локальными) <code>args</code> и <code>result</code>. Но что будет если на локации &#x27;foo&#x27; мы объявим локальную переменную, а затем вызовем из локации &#x27;foo&#x27; локацию &#x27;proc&#x27;, на которой не будем эту переменную объявлять локальной? Какие значения примет переменная на каждой из этих локаций?</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">x</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! объявляем переменную</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;start. x до вызова foo: &lt;&lt;x&gt;&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;start. x после вызова foo: &lt;&lt;x&gt;&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- start -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># foo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token declarator">local</span><span class="token plain"> </span><span class="token user-variable">x</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">333</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo. x до вызова proc: &lt;&lt;x&gt;&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;proc&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo. x после вызова proc: &lt;&lt;x&gt;&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- foo -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># proc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;proc. x до изменения: &lt;&lt;x&gt;&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">x</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">9091</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;proc. x после изменения: &lt;&lt;x&gt;&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- proc -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Что мы увидим при выполнении этого кода? Давайте посмотрим.</p>
<ol>
<li>На локации &quot;start&quot; мы объявили переменную <code>x</code> со значением <code>100</code> и вывели это значение в строке. То есть на экране мы увидим строку с числом <code>100</code>.</li>
<li>Затем мы вызвали локацию &quot;foo&quot;, на которой объявили локальную переменную <code>x</code> со значением <code>333</code> и вывели это значение в строке. То есть на экране мы увидели строку с числом <code>333</code>.</li>
<li>Затем мы вызвали локацию &quot;proc&quot;, и здесь не объявляли переменную <code>x</code> локальной, но вывели её значение в строке. И вот тут мы обнаруживаем отличие в поведении локальных переменных от <code>args</code> и <code>proc</code>. Значение, которое мы увидим в строке будет равно тоже <code>333</code>. То есть в переменную <code>x</code> на локации &quot;proc&quot; транслируется значение этой переменной из локации &quot;foo&quot;, а вернее транслируется сама переменная. Таким образом и локация &quot;proc&quot; и локация &quot;foo&quot; работают по сути с одной и той же переменной. Именно поэтому...</li>
<li>... когда мы изменяем значение <code>x</code> на локации &quot;proc&quot; и ожидаемо видим в выводимой строке число <code>9091</code>, мы изменяем значение <code>x</code> и для локации &quot;foo&quot; в том числе. И поэтому...</li>
<li>... когда плеер возвращается к выполнению кода на локации &quot;foo&quot;, переменная <code>x</code> уже изменена, и мы видим в выводимой строке всё то же число <code>9091</code>.</li>
<li>Когда плеер заканчивает выполнение кода локации &quot;foo&quot; и возвращается к выполнению кода на локации &quot;start&quot;, локальная переменная <code>x</code>, созданная на локации &quot;foo&quot;, автоматически уничтожается, и плеер в дальнейшем продолжает работать с переменной <code>x</code>, созданной на локации &quot;start&quot;. А значит на экране в выводимой строке мы увидим число <code>100</code>.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">start. x до вызова foo: 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo. x до вызова proc: 333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proc. x до изменения: 333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proc. x после изменения: 9091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo. x после вызова proc: 9091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start. x после вызова foo: 100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Не трудно заметить, что локальные переменные ведут себя на локациях, как <code>args</code> в действиях. Всё потому что <code>args</code> автоматически объявляется на локациях, но не в действиях, а локальные переменные необходимо о бъявлять вручную везде, если вам нужно, чтобы они работали как локальные.</p>
<p>Мы можем вручную объявить <code>args</code> локальным в действии, и тогда действие уже не будет работать со значениями <code>args</code> действующими на текущей локации:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">111</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выставляем значение args[0] на локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Действие 1&quot;</span><span class="token label">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Старое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">222</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! изменяем значение args[0] не только в действии, а сразу на локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Новое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Действие 2&quot;</span><span class="token label">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Старое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">333</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! изменяем значение args[0] не только в действии, а сразу на локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Новое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Действие 3&quot;</span><span class="token label">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token declarator">local</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! объявляем args локальным</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Старое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">999</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! изменяем значение args[0] только в действии,но не на локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Новое значение args[0]: &quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">$str</span><span class="token sign-punctuation">(</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>И точно так же, если мы вручную не объявим на локации локальную переменную, мы будем работать с той переменной, которая была объявлена последней до вызова этой локации. Если мы вообще не объявляли локальную переменную, значит будем работать с переменной общей для всей игры — с глобальной переменной.</p>
<p>Имея в наличии такой удобный инструмент, как локальные переменные, мы оказываемся избавлены от необходимости использовать <code>args</code> для замены этих самых локальных переменных, и можем использовать его только по прямому назначению, то есть получать из этого массива переданные на локацию аргументы. Посмотрите, насколько чище и понятнее при этом выглядит код:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! # #chk.obj.word#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token declarator">local</span><span class="token plain"> </span><span class="token user-variable">$word</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! в локальную переменную $word записываем слово, по которому производим поиск</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token declarator">local</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! используем локальную переменную i в качестве счётчика цикла</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">loop</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">no</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">countobj</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">step</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">+=</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    !@ цикл выполняется пока счётчик не превысит число предметов</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">instr</span><span class="token sign-punctuation">(</span><span class="token builtin">$getobj</span><span class="token sign-punctuation">(</span><span class="token user-variable">i</span><span class="token sign-punctuation">)</span><span class="token sign-punctuation">,</span><span class="token user-variable">$word</span><span class="token sign-punctuation">)</span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        !@ как только в названии очередного предмета</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        !@ встречается рассматриваемое слово</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token sys-variable">result</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; !@ возвращаем позицию</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">exit</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; !@ закрываем функцию</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="неявный-вызов-функций">Неявный вызов функций<a href="#неявный-вызов-функций" class="hash-link" aria-label="Прямая ссылка на Неявный вызов функций" title="Прямая ссылка на Неявный вызов функций">​</a></h3>
<p>Как мы уже говорили ранее, сами по себе локации в действительности не являются функциями или процедурами. Мы используем оператор <code>gosub</code> или специальную функцию <code>func</code>, чтобы выполнить код той или иной локации. Функциями мы называли эти локации для удобства. И точно так же для удобства в QSP версии 5.8.0 была введена особая синтаксическая конструкция, которая позволяет не писать оператор <code>gosub</code> и функцию <code>func</code>.</p>
<p>Фактически мы теперь всегда вызываем все локации с помощью функции <code>func</code>, но имеем возможность не указывать само ключевое слово <code>func</code>. И такая запись данной функции называется <code>неявным вызовом</code>.</p>
<p>Неявный вызов делается так: мы пишем символ <code>@</code> и сразу после него без пробелов указываем название локации, которую хотим использовать как функцию. Если нам нужно передать на локацию аргументы, мы перечисляем эти аргументы внутри круглых скобок сразу после названия локации:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! возводим числа в степень</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">@pow</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет число 81</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">@pow</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет число 64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">@pow</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">9</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">9</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&amp; ! выведет число 387420489</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- start -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># pow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! функция возведения числа в степень.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! Мы писали её для dyneval, а теперь оформляем в отдельной локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">loop</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">step</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">-=</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">*</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- pow -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Таким образом наш код становится ещё более наглядным и читаемым, и мы легко отделяем визуально передаваемые на локацию аргументы от названия самой локации.</p>
<p>В остальном всё работет, как прежде.</p>
<p>Если на локации мы присваиваем значение переменной <code>result</code>, значит функция вернёт нам это значение.</p>
<p>Если на локации переменной <code>result</code> не присваивается никакое значение, функция ничего не возвращает, и тогда её поведение ничем не отличается от поведения <code>gosub</code>.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">@pl_stat</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;Леголас&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">137</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;Лук и стрелы&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- start -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># pl_stat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вас зовут &lt;&lt;$args[0]&gt;&gt;.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вам &lt;&lt;args[1]&gt;&gt; лет.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Вы используете &lt;&lt;$args[2]&gt;&gt;.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">- pl_stat -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="заключение">Заключение<a href="#заключение" class="hash-link" aria-label="Прямая ссылка на Заключение" title="Прямая ссылка на Заключение">​</a></h2>
<p>В данной статье мы попытались максимально подробно объяснить, что такое операторы, функции, как мы можем писать собственные функции и процедуры в QSP, что такое аргументы и зачем нужен массив <code>args</code>. Вы узнали, что такое локальные переменные, и как массив <code>args</code> заменяет локальные переменные в плеерах версии 5.7.0, и почему это больше не требуется в плеерах версии 5.8.0 и выше.</p>
<p>Многие моменты остались за рамками данной статьи. Например, что за значения появляются в массиве <code>args</code> на локациях-обр аботчиках пунктов пользовательского меню, или какие значения можно найти в массиве <code>args</code> на локации <code>onNewLoc</code>, но на все эти вопросы, мы надеемся, вы найдёте ответы в большом <a href="https://aleksversus.github.io/howdo_faq" target="_blank" rel="noopener noreferrer">справочнике по самым часто задаваемым вопросам из темы &quot;Как сделать?&quot; на форуме qsp.org</a>.</p>
<p>Онлайн-версию справочника, а так же полный текст данной статьи вы можете найти <a href="https://aleksversus.github.io/howdo_faq/" target="_blank" rel="noopener noreferrer">вот по этой ссылке</a>.</p>
<p>Если прочтение статьи не прибавило ясности, попробуйте ознакомиться с материалом следующих видеороликов:</p>
<ul>
<li><a href="https://youtu.be/701GnjpRGU0" target="_blank" rel="noopener noreferrer">Уроки по QSP. Номер 11. Операторы, функции и аргументы</a></li>
<li><a href="https://youtu.be/TGUhW-2l1gM" target="_blank" rel="noopener noreferrer">Уроки по QSP. Номер 21. Пользовательские служебные локации. Часть 1</a></li>
<li><a href="https://youtu.be/701GnjpRGU0" target="_blank" rel="noopener noreferrer">Уроки по QSP. Номер 21. Пользовательские служебные локации. Часть 2</a></li>
<li><a href="https://www.youtube.com/watch?v=aEdgMuqTlH8&amp;list=PLcAHO4WsUl2RLdiV5Lfi4d_yyHpl7zTJA&amp;index=31&amp;t=4517s" target="_blank" rel="noopener noreferrer">Что нового в QSP 5.8.0. Объявление локальных переменных</a></li>
<li><a href="https://www.youtube.com/watch?v=aEdgMuqTlH8&amp;t=3080s" target="_blank" rel="noopener noreferrer">Что нового в QSP 5.8.0. Неявный вызов функций</a></li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href="/howdo_faq/docs/articles/config_classic_570"><div class="pagination-nav__sublabel">Предыдущая страница</div><div class="pagination-nav__label">Структура конфигурационного файла классического плеера версии 5.7.0</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/howdo_faq/docs/articles/stylization_manifest"><div class="pagination-nav__sublabel">Следующая страница</div><div class="pagination-nav__label">Манифест об организации кода в QSP</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#пробуем-воду-немного-определений" class="table-of-contents__link toc-highlight">Пробуем воду. Немного определений</a><ul><li><a href="#операторы" class="table-of-contents__link toc-highlight">Операторы</a></li><li><a href="#функции" class="table-of-contents__link toc-highlight">Функции</a></li></ul></li><li><a href="#плаваем-у-берега-пользовательские-функции-и-процедуры" class="table-of-contents__link toc-highlight">Плаваем у берега. Пользовательские функции и процедуры</a></li><li><a href="#глубокое-погружение-тонкости-и-нюансы-при-написании-собственных-функций-и-процедур" class="table-of-contents__link toc-highlight">Глубокое погружение. Тонкости и нюансы при написании собственных функций и процедур</a></li><li><a href="#бездна-смотрит-в-тебя-локальные-переменные-и-неявный-вызов-пользовательских-функций" class="table-of-contents__link toc-highlight">Бездна смотрит в тебя. Локальные переменные и неявный вызов пользовательских функций</a><ul><li><a href="#локальные-переменные" class="table-of-contents__link toc-highlight">Локальные переменные</a></li><li><a href="#неявный-вызов-функций" class="table-of-contents__link toc-highlight">Неявный вызов функций</a></li></ul></li><li><a href="#заключение" class="table-of-contents__link toc-highlight">Заключение</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"><aside class="footerBlock">
<div class="eBlock">
<div class="avsPageStamp">
    <p class="emptyP">Aleks Versus'HowDo-F.A.Q'2019-2024. Built with Docusaurus.<br></p>
    <p class="emptyP">Aleks Versus'Game Adventure Making'Really Unimaginable Stories'2019-2024</p>
</div></div>
</aside></div></div></div></footer></div>
</body>
</html>