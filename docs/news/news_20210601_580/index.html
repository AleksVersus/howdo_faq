<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-news/news_20210601_580" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Нововведения в QSP 5.8.0 | Справочник | F.A.Q.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aleksversus.github.io/howdo_faq/res/favicon.ico"><meta data-rh="true" name="twitter:image" content="https://aleksversus.github.io/howdo_faq/res/favicon.ico"><meta data-rh="true" property="og:url" content="https://aleksversus.github.io/howdo_faq/docs/news/news_20210601_580"><meta data-rh="true" property="og:locale" content="ru"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Нововведения в QSP 5.8.0 | Справочник | F.A.Q."><meta data-rh="true" name="description" content="Пока готовится выход нового плеера версии 5.8.0 (или выше), мы решили рассказать о грядущих нововведениях. Всё (или почти всё), что будет представлено в этой статье, вы уже можете пощупать в плеере &quot;qSpider&quot; от Werewolf&#x27;а."><meta data-rh="true" property="og:description" content="Пока готовится выход нового плеера версии 5.8.0 (или выше), мы решили рассказать о грядущих нововведениях. Всё (или почти всё), что будет представлено в этой статье, вы уже можете пощупать в плеере &quot;qSpider&quot; от Werewolf&#x27;а."><link data-rh="true" rel="icon" href="/howdo_faq/res/favicon.ico"><link data-rh="true" rel="canonical" href="https://aleksversus.github.io/howdo_faq/docs/news/news_20210601_580"><link data-rh="true" rel="alternate" href="https://aleksversus.github.io/howdo_faq/docs/news/news_20210601_580" hreflang="ru"><link data-rh="true" rel="alternate" href="https://aleksversus.github.io/howdo_faq/docs/news/news_20210601_580" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Нововведения в QSP 5.8.0","item":"https://aleksversus.github.io/howdo_faq/docs/news/news_20210601_580"}]}</script><link rel="stylesheet" href="/howdo_faq/assets/css/styles.6556fb06.css">
<script src="/howdo_faq/assets/js/runtime~main.70a0a106.js" defer="defer"></script>
<script src="/howdo_faq/assets/js/main.ae4c95f8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/howdo_faq/"><b class="navbar__title text--truncate">Главная</b></a><a class="navbar__item navbar__link" href="/howdo_faq/docs/howdo/intro">Как сделать? F.A.Q.</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/howdo_faq/docs/news/news_content">Новости QSP</a><a class="navbar__item navbar__link" href="/howdo_faq/docs/articles/type_casting">Статьи</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/howdo_faq/docs/informarch/intro">Информ-Архив</a><a class="navbar__item navbar__link" href="/howdo_faq/docs/wiki/start">QSP-wiki</a><a href="https://github.com/AleksVersus/howdo_faq" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub/HowDo_F.A.Q<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Переключение между темным и светлым режимом (сейчас используется system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/news/news_content"><span title="Новости QSP" class="linkLabel_WmDU">Новости QSP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/news/news_20251003_594"><span title="Нововведения в QSP 5.9.2-5.9.4" class="linkLabel_WmDU">Нововведения в QSP 5.9.2-5.9.4</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/news/news_20241126_591"><span title="Нововведения в QSP 5.9.1" class="linkLabel_WmDU">Нововведения в QSP 5.9.1</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/news/news_20240909_590"><span title="Нововведения в QSP 5.9.0" class="linkLabel_WmDU">Нововведения в QSP 5.9.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/howdo_faq/docs/news/news_20210601_580"><span title="Нововведения в QSP 5.8.0" class="linkLabel_WmDU">Нововведения в QSP 5.8.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/howdo_faq/docs/news/news_20100613_570"><span title="Обновление QSP (5.7.0) и QGen (4.0.0b)" class="linkLabel_WmDU">Обновление QSP (5.7.0) и QGen (4.0.0b)</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Главная страница" class="breadcrumbs__link" href="/howdo_faq/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Нововведения в QSP 5.8.0</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><header><h1>Нововведения в QSP 5.8.0</h1></header>
<p>Пока готовится выход нового плеера версии 5.8.0 (или выше), мы решили рассказать о грядущих нововведениях. Всё (или почти всё), что будет представлено в этой статье, вы уже можете пощупать в плеере <a href="https://qsp.org/index.php?option=com_agora&amp;task=topic&amp;id=1291&amp;Itemid=57" target="_blank" rel="noopener noreferrer" class="">&quot;qSpider&quot; от Werewolf&#x27;а</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="последние-нововведения">Последние нововведения<a href="#последние-нововведения" class="hash-link" aria-label="Прямая ссылка на Последние нововведения" title="Прямая ссылка на Последние нововведения" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="изменение-в-работе-массивов">Изменение в работе массивов<a href="#изменение-в-работе-массивов" class="hash-link" aria-label="Прямая ссылка на Изменение в работе массивов" title="Прямая ссылка на Изменение в работе массивов" translate="no">​</a></h3>
<p>Это, пожалуй, самое основное из грядущих изменений, и о нём мы подробно писали в ста тье <a class="" href="/howdo_faq/docs/articles/arrays_580/">&quot;Массивы уже не те&quot;</a>. Здесь же изложим кратко.</p>
<p>Теперь в массиве будет нельзя под одним индексом хранить и текстовое и числовое значение. Если вы запишете в ячейку числовое значение, а потом запишете в ту же ячейку текстовое значение, текстовое значение затрёт числовое.</p>
<p>При этом, если вы попытаетесь получить из ячейки со строковым значением числовое значение, плеер вернёт значение по умолчанию, то есть <code>0</code>. И наоборот: если попытаться из ячейки с числовым значением получить строковое, плеер вернёт пустую строку.</p>
<p>Примеры:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.7.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! выведет число 123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;string&#x27;</span><br></span></code></pre></div></div>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! затирает числовое значение</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! попытка доступа к числовому значению вернёт 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;string&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="многомерные-массивы">Многомерные массивы<a href="#многомерные-массивы" class="hash-link" aria-label="Прямая ссылка на Многомерные массивы" title="Прямая ссылка на Многомерные массивы" translate="no">​</a></h3>
<p>Чтобы организовать многомерный массив, в плеерах версии 5.7.0 (и более ранних) приходилось использовать текстовые индексы. Например:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в плеерах любых версий:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$unit_coords</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&quot;3,1&quot;</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Пехотинец&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$unit_coords</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&quot;2,7&quot;</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Артилерист&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$unit_coords</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&quot;10,0&quot;</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Танк&quot;</span><br></span></code></pre></div></div>
<p>Но в новых версиях плеера (начиная с 5.8.0 и выше) можно не использовать текстовые индексы, а указывать несколько нужных значений через запятую:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$unit_coords</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Пехотинец&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$unit_coords</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">7</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Артилерист&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$unit_coords</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">10</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Танк&quot;</span><br></span></code></pre></div></div>
<p>Это намного упрощает работу с многомерными массивами.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="изменения-в-работе-логических-операторов-и-функций">Изменения в работе логических операторов и функций<a href="#изменения-в-работе-логических-операторов-и-функций" class="hash-link" aria-label="Прямая ссылка на Изменения в работе логических операторов и функций" title="Прямая ссылка на Изменения в работе логических операторов и функций" translate="no">​</a></h3>
<p>Все мы знаем, что QSP не поддерживает булевые (логические) типы данных, а вместо них в плеерах версии 5.7.0. использовались числа <code>0</code> и <code>-1</code>.</p>
<p>Здесь <code>0</code> означало Ложь (False), а <code>-1</code> означало Правду (<code>True</code>). Соответственно и все логические операции возвращали нам эти значения.</p>
<p>Например:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.7.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! AND вернёт -1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OR вернёт -1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">no</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! NO вернёт -1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! AND вернёт 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OR вернёт 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">no</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! NO вернёт 0</span><br></span></code></pre></div></div>
<p>В новых версиях плеера все логические операции будут возвращать <code>1</code> в случае Правды (<code>True</code>), и <code>0</code> в случае Лжи (<code>False</code>):</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! AND вернёт 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OR вернёт 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">no</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! NO вернёт 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! AND вернёт 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OR вернёт 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">no</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! NO вернёт 0</span><br></span></code></pre></div></div>
<p>Соответственно и различные функции, возвращавшие &quot;логические&quot; значения, будут возвращать либо <code>1</code> (Правда, <code>True</code>), либо <code>0</code> (Ложь, <code>False</code>):</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.7.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Отвёртка&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">obj</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;Отвёртка&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OBJ вернёт -1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">obj</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;Оттка&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OBJ вернёт 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">isnum</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! ISNUM вернёт -1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">isnum</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;12d&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! ISNUM вернёт 0</span><br></span></code></pre></div></div>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Отвёртка&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">obj</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;Отвёртка&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OBJ вернёт 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">obj</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;Оттка&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OBJ вернёт 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">isnum</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! ISNUM вернёт 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">isnum</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;12d&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! ISNUM вернёт 0</span><br></span></code></pre></div></div>
<p>Ещё одно изменение в работе логических операций заключается в том, что теперь они на самом деле будут логическими. Да, оказывается в плеерах версий 5.7.0 и старше операции <code>AND</code>, <code>OR</code>, <code>NO</code> не были логическими — они были побитовыми. Это означает, что данные операции могли выполнять сравнение чисел по отдельным битам и возвращать результат этого сравнения.</p>
<p>Например:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.7.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! AND вернёт 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OR вернёт 6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">no</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! NO вернёт -8</span><br></span></code></pre></div></div>
<p>Теперь же, не имеет значения, какое число мы передаём логическому оператору. Если это число отлично от нуля, логический оператор будет воспринимать его как <code>1</code>, то есть Правду (<code>True</code>).</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версия 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! AND вернёт 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! OR вернёт 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">no</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! NO вернёт 0</span><br></span></code></pre></div></div>
<p>И это логично, ведь именно по такому принципу и работали операторы проверки условия <code>if</code> и <code>elseif</code>. Если этим операторам передавалось значение отличное от <code>0</code>, то это означало, что условие верно (Правда, <code>True</code>).</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! одинаково для всех версий плеера:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;условие выполнено&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;условие не выполнено&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;условие выполнено&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;условие не выполнено&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="аргументы-передаваемые-с-операторами-goto-и-xgoto">Аргументы, передаваемые с операторами GOTO и XGOTO<a href="#аргументы-передаваемые-с-о ператорами-goto-и-xgoto" class="hash-link" aria-label="Прямая ссылка на Аргументы, передаваемые с операторами GOTO и XGOTO" title="Прямая ссылка на Аргументы, передаваемые с операторами GOTO и XGOTO" translate="no">​</a></h3>
<p>Теперь аргументы (параметры, данные), передаваемые с операторами <code>GOTO</code> и <code>XGOTO</code>, и которые мы можем получить из массива <code>ARGS</code> на локации, однозначно можно будет использовать в действиях, созданных на этой локации.</p>
<p>Раньше это тоже можно было делать, однако в плеере присутствовал досадный баг, который периодически ломал всё это дело. Этот баг исправили, и теперь всё прекрасно работает:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># локация_1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;локация_2&quot;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&quot;текст&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--локация_1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># локация_2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Действие&quot;</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--локация_2</span><br></span></code></pre></div></div>
<p>Обратите внимание, <code>ARGS</code> ведёт себя на текущей локации, как обычный глобальный массив. Т.е., если вы изменяете значения <code>ARGS</code> в одном из действий, эти же значения будут использоваться в других действиях.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># локация_1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;локация_2&quot;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&quot;из аргументов&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--локация_1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># локация_2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Действие - 1&quot;</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Из действия 1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Действие - 2&quot;</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Из действия 2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--локация_2</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="disablesubex-больше-нет">DISABLESUBEX больше нет<a href="#disablesubex-больше-нет" class="hash-link" aria-label="Прямая ссылка на DISABLESUBEX больше нет" title="Прямая ссылка на DISABLESUBEX больше нет" translate="no">​</a></h3>
<p>Системная переменная <code>DISABLESUBEX</code> была предназначена для того, чтобы отключать обработку вложенных выражений. Например, если вы хотели вывести строку, в которой присутствуют вложенные выражения, без изменений, вы могли воспользоваться данной переменной:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! в версии 5.7.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">health</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Здоровье &lt;&lt;health&gt;&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье 100&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">disablesubex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Здоровье &lt;&lt;health&gt;&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье &lt;&lt;health&gt;&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">disablesubex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Здоровье &lt;&lt;health&gt;&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье 100&#x27;</span><br></span></code></pre></div></div>
<p>В плеерах более новых версий это не сработает:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! в версии 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">health</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Здоровье &lt;&lt;health&gt;&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье 100&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">disablesubex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Здоровье &lt;&lt;health&gt;&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье 100&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">disablesubex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Здоровье &lt;&lt;health&gt;&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье 100&#x27;</span><br></span></code></pre></div></div>
<p>Чтобы вывести строку с подвыражениями без обработки таких вложенных выражений в новых версиях плеера, можно использовать фигурные скобки:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! одинаково работает во всех версиях плеера</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">health</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Здоровье &lt;&lt;health&gt;&gt;&quot;</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье 100&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sign-punctuation">{</span><span class="token user-variable">Здоровье</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token user-variable">health</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token sign-punctuation">}</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье &lt;&lt;health&gt;&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Здоровье &lt;&lt;health&gt;&gt;&quot;</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет строку &#x27;Здоровье 100&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="изменения-в-работе-неявного-оператора">Изменения в работе неявного оператора<a href="#изменения-в-работе-неявного-оператора" class="hash-link" aria-label="Прямая ссылка на Изменения в работе неявного оператора" title="Прямая ссылка на Изменения в работе неявного оператора" translate="no">​</a></h3>
<p>Неявный оператор — это оператор, который мы не указываем. В 5.7.0 он делал примерно то же, что делал и оператор <code>*pl</code>. То есть выводил на экран значение, добавляя после этого значения перевод строки:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в плеерах любых версий</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! эквивалентно:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">456</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! здесь для вывода используется неявный оператор</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! и здесь для вывода и спользуется неявный оператор</span><br></span></code></pre></div></div>
<p>Если мы вызывали какую-то функцию, но она не возвращала никакого результата, неявный оператор, как и оператор <code>*pl</code>, выводил на экран пустую строку и добавлял к ней перевод строки:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># loc1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;Строка текста&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;Строка текста&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--loc1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># foo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">N</span><span class="token operator" style="color:#393A34">=</span><span class="token user-variable">R</span><span class="token operator" style="color:#393A34">*</span><span class="token user-variable">L</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--foo</span><br></span></code></pre></div></div>
<p>Вот что мы увидим на экране в плеерах версии 5.7.0:</p>
<div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Строка текста</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Строка текста</span><br></span></code></pre></div></div>
<p>В новых версиях плеера, если неявный оператор не получит никакого значения от функции, он просто ничего не будет делать. Вот что мы увидим на экране в плеерах версии 5.8.0 и выше:</p>
<div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Строка текста</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Строка текста</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="неявный-вызов-пользовательских-функций">Неявный вызов пользовательских функций<a href="#неявный-вызов-пользовательских-функций" class="hash-link" aria-label="Прямая ссылка на Неявный вызов пользовательских функций" title="Прямая ссылка на Неявный вызов пользовательских функций" translate="no">​</a></h3>
<p>В плеерах версии 5.7.0 и более ранних вы могли написать собственную функцию и затем вызвать её без возвращения результата, используя оператор <code>GOSUB</code>, или с возвращением результата, используя функцию <code>FUNC</code>. В плеерах версии 5.8.0 и выше эта возможность конечно же сохраняется.</p>
<p>Пример:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает во всех версиях плеера</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;proced&#x27;</span><span class="token plain">            </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! вызов без возвращения результата</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">func</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">23</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">45</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! вызов с возвращением результата</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># proced</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Action&quot;</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;text&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--proced</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># foo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--foo</span><br></span></code></pre></div></div>
<p>Однако в плеерах версии 5.8.0 и выше вы можете использовать сокращённую запись вызова таких функций:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает только в 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token user-variable">proced</span><span class="token plain">            </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! вызов без возвращения результата</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">@foo</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">23</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">45</span><span class="token sign-punctuation">)</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! вызов с возвращением результата</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># proced</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">act</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Action&quot;</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;text&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--proced</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># foo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">result</span><span class="token operator" style="color:#393A34">=</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--foo</span><br></span></code></pre></div></div>
<p>То есть вместо того, чтобы использовать явное указание оператора gosub или функции <code>func</code>, можно писать символ <code>@</code>, а после него без пробелов записывать название локации. Само название вызываемой таким образом локации/функции так же не должно содержать пробелов.</p>
<p>Если такой функции нужно передать значения, после названия локации ставим скобки и перечисляем нужные аргументы.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="новая-функция-arritem">Новая функция ARRITEM<a href="#новая-функция-arritem" class="hash-link" aria-label="Прямая ссылка на Новая функция ARRITEM" title="Прямая ссылка на Новая функция ARRITEM" translate="no">​</a></h3>
<p>Функция <code>ARRITEM</code> возвращает значение указанной ячейки массива. Это новая функция, и введена она по большей части для того, чтобы упразднять подвыражения при использовании <code>DYNAMIC</code>/<code>DYNEVAL</code>.</p>
<p>Примеры:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">massive</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">123</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! работает в любой версии плеера:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">xvar</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token user-variable">massive</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">123</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! работает только в 5.8.0 и выше:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">xvar</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">arritem</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;massive&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">123</span><span class="token sign-punctuation">)</span><br></span></code></pre></div></div>
<p>Обе команды присваивают переменной <code>xvar</code> значение из ячейки <code>123</code> массива <code>&#x27;massive</code>&#x27;, однако во втором случае мы указываем название в виде строкового значения. Таким образом мы, не прибегая к помощи <code>DYNAMIC</code>/<code>DYNEVAL</code> можем динамически формировать названия массива при получении значения.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! $stringarray[345]=&#x27;text out&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;array&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">$arritem</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;$&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">345</span><span class="token sign-punctuation">)</span><br></span></code></pre></div></div>
<p>Так же <code>ARRITEM</code> позволяет получить значение из ячейки с текстовым индексом:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&quot;text index&quot;</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;text string&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token builtin">$arritem</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;$mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;text index&#x27;</span><span class="token sign-punctuation">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="killvar-удаляет-по-текстовому-индексу">KILLVAR удаляет по текстовому индексу<a href="#killvar-удаляет-по-текстовому-индексу" class="hash-link" aria-label="Прямая ссылка на KILLVAR удаляет по текстовому индексу" title="Прямая ссылка на KILLVAR удаляет по текстовому индексу" translate="no">​</a></h3>
<p>В плеерах версии 5.7.0 и ниже оператор <code>KILLVAR</code> умел удалять элементы массивов только по числовому индексу:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в плеерах любых версий</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&quot;text index&quot;</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 3&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 4&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! удаление по числовому индексу</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">killvar</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет на экран строку &#x27;строка 3&#x27;</span><br></span></code></pre></div></div>
<p>В плеерах версии 5.8.0 и выше <code>KILLVAR</code> умеет удалять элементы массивов не только по числовому, но и по текстовому индексу:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает только в 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token string" style="color:#e3116c">&quot;text index&quot;</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 3&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">4</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;строка 4&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! удаление по числовому индексу</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">killvar</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;text index&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">$mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! выведет на экран строку &#x27;строка 4&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="операторы-addqst-и-killqst-переименованы">Операторы ADDQST и KILLQST переименованы<a href="#операторы-addqst-и-killqst-переименованы" class="hash-link" aria-label="Прямая ссылка на Операторы ADDQST и KILLQST переименованы" title="Прямая ссылка на Операторы ADDQST и KILLQST переименованы" translate="no">​</a></h3>
<p>В плеерах версии 5.7.0 (за исключением Quest Navigator) используются операторы <code>ADDQST</code> и <code>KILLQST</code>. В плеерах более новых версий (5.8.0 и выше) данные операторы заменены на <code>INCLIB</code> и <code>FREELIB</code> соответственно.</p>
<p><code>INCLIB</code> добавляет локации из подключаемого модуля QSP к основной игре.
<code>FREELIB</code> удаляет все локации ранее подключённых модулей QSP из основной игры.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">inclib</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module.qsp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">inclib</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;drive.qsp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">inclib</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;base.qsp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">freelib</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="изменение-в-работе-оператора-set">Изменение в работе оператора SET<a href="#изменение-в-работе-оператора-set" class="hash-link" aria-label="Прямая ссылка на Изменение в работе оператора SET" title="Прямая ссылка на Изменение в работе оператора SET" translate="no">​</a></h3>
<p>Для явного объявления переменных в QSP используется оператор <code>SET</code>. В плеерах версии 5.7.0 и ниже с помощью этого оператора вы могли объявить лишь одну переменную:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в плеерах любых версий</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">45</span><br></span></code></pre></div></div>
<p>Если требовалось объявить несколько переменных, приходилось писать несколько команд <code>SET</code>:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в плеерах любых версий</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">45</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token user-variable">daz</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">65</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token user-variable">zaz</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">79</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! эквивалентно:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">mass</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">45</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token user-variable">daz</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">65</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token user-variable">zaz</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">79</span><br></span></code></pre></div></div>
<p>В плеерах версии 5.8.0. и выше вы можете объявить несколько переменных одной командой:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в 5.8.0 и выше:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">daz</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">zaz</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">65</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><br></span></code></pre></div></div>
<p>Обратите внимание на форму записи. Здесь лишь один знак <code>=</code>. Переменные и их значения перечислены через запятую соответственно слева и справа от знака <code>=</code>.</p>
<p>Более того. С помощью оператора <code>SET</code> вы можете не только назначать переменным определённые значения, но и присваивать значения других переменных:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в 5.8.0 и выше:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token user-variable">a</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">b</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">c</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token user-variable">x</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">y</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">z</span><br></span></code></pre></div></div>
<p>В том числе и менять значения переменных местами не прибегая к помощи третьей переменной:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в 5.8.0 и выше:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token user-variable">j</span><span class="token sign-punctuation">,</span><span class="token user-variable">y</span><span class="token operator" style="color:#393A34">=</span><span class="token user-variable">y</span><span class="token sign-punctuation">,</span><span class="token user-variable">j</span><br></span></code></pre></div></div>
<p>Само собой, как и в плеерах версии 5.7.0, оператор <code>SET</code> указывать не обязательно:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в 5.8.0 и выше:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">mass</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">daz</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">zaz</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">65</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">a</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">b</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">c</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token user-variable">x</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">y</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">z</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">j</span><span class="token sign-punctuation">,</span><span class="token user-variable">y</span><span class="token operator" style="color:#393A34">=</span><span class="token user-variable">y</span><span class="token sign-punctuation">,</span><span class="token user-variable">j</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="новый-оператор-local">Новый оператор LOCAL<a href="#новый-оператор-local" class="hash-link" aria-label="Прямая ссылка на Новый оператор LOCAL" title="Прямая ссылка на Новый оператор LOCAL" translate="no">​</a></h3>
<p>В плеерах версии 5.8.0 и выше, а так же в Quest Navigator появился новый оператор, который позволяет объявить указанные переменные локальными для отдельного блока кода (локации, действия, код в <code>DYNAMIC</code>/<code>DYNEVAL</code>). После того, как блок кода выполнен, значения переменных восстанавливаются к предыдущим:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">99</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">gosub</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># foo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">45</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--foo</span><br></span></code></pre></div></div>
<p>Можно объявить локальную переменную и сразу присвоить ей значение:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">45</span><br></span></code></pre></div></div>
<p>Можно объявить сразу несколько локальных переменных:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! объявляем локальные переменные </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">j</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">k</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! объявляем локальные переменные и присваиваем им значения</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token user-variable">f</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">d</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">$g</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><br></span></code></pre></div></div>
<p>Обратите внимание на последнюю форму записи. Сначала мы перечисляем объявляемые переменные через запятую, затем ставим один знак <code>=</code>, а после него перечисляем через запятую значения, которые хотим присвоить переменным. Неправильно делать такую запись:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token quoted-comment comment" style="color:#999988;font-style:italic">! Данная строчка кода вызовет ошибку &quot;Несоответствие типов данных&quot;:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token user-variable">f</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">d</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">45</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token user-variable">$g</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="изменения-в-работе-функций-instr-arrcomp-arrpos">Изменения в работе функций INSTR, ARRCOMP, ARRPOS<a href="#изменения-в-работе-функций-instr-arrcomp-arrpos" class="hash-link" aria-label="Прямая ссылка на Изменения в работе функций INSTR, ARRCOMP, ARRPOS" title="Прямая ссылка на Изменения в работе функций INSTR, ARRCOMP, ARRPOS" translate="no">​</a></h3>
<p>Необязательные аргументы функций <code>INSTR</code>, <code>ARRCOMP</code> и <code>ARRPOS</code> в плеерах 5.8.0 и выше, а так же в Quest Navigator переставлены в конец. В плеерах версии 5.7.0. и ниже эти аргументы шли в начале.</p>
<p>Примеры для версий плеера 5.7.0 и ниже:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! поиск подстроки в строке, начиная с 7го символа</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">instr</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">7</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&quot;В корзине 23 красных и 47 синих яблок.&quot;</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;красн&quot;</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! поиск среди элементов массива элемента, который содержит число 23, начиная с 13 элемента</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">arrpos</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">13</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">23</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! поиск среди элементов массива элемента, который соответствует регулярному выражению, начиная с пятого элемента</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">arrcomp</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">5</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;$objectbox&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;\S{2}\s\S{6}&#x27;</span><span class="token sign-punctuation">)</span><br></span></code></pre></div></div>
<p>Те же самые примеры для плееров версии 5.8.0 и выше и Quest Navigator`а:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! поиск подстроки в строке, начиная с 7го символа</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">instr</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&quot;В корзине 23 красных и 47 синих яблок.&quot;</span><span class="token sign-punctuation">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;красн&quot;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">7</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! поиск среди элементов массива элемента, который содержит число 23, начиная с 13 элемента</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">arrpos</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">23</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">13</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! поиск среди элементов массива элемента, который соответствует регулярному выражению, начиная с пятого элемента</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">arrcomp</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;$objectbox&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;\S{2}\s\S{6}&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">5</span><span class="token sign-punctuation">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="новый-оператор-цикла-loop">Новый оператор цикла LOOP<a href="#новый-оператор-цикла-loop" class="hash-link" aria-label="Прямая ссылка на Новый оператор цикла LOOP" title="Прямая ссылка на Новый оператор цикла LOOP" translate="no">​</a></h3>
<p>В плеерах версий 5.7.0 и старше, для организации циклов приходилось использовать метки. Начиная с версии 5.8.0. у нас появляется отдельный оператор циклов <code>LOOP</code>. Вот как он записывается в общем виде:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! многострочная форма:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">LOOP</span><span class="token plain"> </span><span class="token sign-punctuation">[</span><span class="token user-variable">команды</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHILE</span><span class="token plain"> </span><span class="token sign-punctuation">[</span><span class="token user-variable">условие</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">STEP</span><span class="token plain"> </span><span class="token sign-punctuation">[</span><span class="token user-variable">команды</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token sign-punctuation">[</span><span class="token user-variable">команды</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">END</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! однострочная форма:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">LOOP</span><span class="token plain"> </span><span class="token sign-punctuation">[</span><span class="token user-variable">команды</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHILE</span><span class="token plain"> </span><span class="token sign-punctuation">[</span><span class="token user-variable">условие</span><span class="token sign-punctuation">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">STEP</span><span class="token plain"> </span><span class="token sign-punctuation">[</span><span class="token user-variable">команды</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">]</span><span class="token sign-punctuation">:</span><span class="token plain"> </span><span class="token sign-punctuation">[</span><span class="token user-variable">команды</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">]</span><br></span></code></pre></div></div>
<p>Здесь, как вы видите, есть целых три ключевых слова:</p>
<ul>
<li class=""><code>LOOP</code> — это ключевое слово объявляет, что начинается цикл, оно обязательно. После <code>LOOP</code> могут идти некоторые однострочные операторы. Например, здесь мы можем объявить локальные переменные, которые будут считаться локальными только для данного цикла.</li>
<li class=""><code>WHILE</code> — после этого ключевого слова должно стоять условие, и пока выполняется это условие, цикл тоже будет выполняться.</li>
<li class=""><code>STEP</code> — это ключевое слово не является обязательным, однако оно удобно, чтобы перечислить однострочные операторы, не относящиеся напрямую к телу цикла. Например, здесь можно указать изменение счётчика.</li>
</ul>
<p>Непосредственно тело цикла, то есть его основные команды пишутся после двоеточия. Для однострочной формы — в той же строке, что и <code>loop</code>, а для многострочной формы — в последующих строках сразу после двоеточия. Многострочную форму необходимо завершать ключевым словом <code>END</code>.</p>
<p>Несколько примеров:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! выведет на экран таблицу умножения на 12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">loop</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">step</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">+=</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;12 * &lt;&lt;i&gt;&gt; = &lt;&lt;12*i&gt;&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre></div></div>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! поиск всех позиций элементов массива, содержащих число 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">loop</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token sign-punctuation">,</span><span class="token user-variable">pos</span><span class="token sign-punctuation">,</span><span class="token user-variable">true</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">,</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token user-variable">true</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token user-variable">pos</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">arrpos</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">,</span><span class="token user-variable">pos</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token sign-punctuation">(</span><span class="token user-variable">pos</span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token user-variable">pos</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token user-variable">pos</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">=</span><span class="token user-variable">pos</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mass[&lt;&lt;pos&gt;&gt;] = 3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token user-variable">true</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre></div></div>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! нарезаем неповторяющиеся символы из строки</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">$string</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;long long long string&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">loop</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token sign-punctuation">(</span><span class="token user-variable">$string</span><span class="token sign-punctuation">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token user-variable">$a</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">$mid</span><span class="token sign-punctuation">(</span><span class="token user-variable">$string</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">arrpos</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;$letters&#x27;</span><span class="token sign-punctuation">,</span><span class="token user-variable">$a</span><span class="token sign-punctuation">)</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token user-variable">$letters</span><span class="token sign-punctuation">[</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token user-variable">$a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token sign-punctuation">(</span><span class="token user-variable">$string</span><span class="token sign-punctuation">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token user-variable">$string</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">$mid</span><span class="token sign-punctuation">(</span><span class="token user-variable">$string</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">2</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token user-variable">$string</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! выводим на экран</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">loop</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token sign-punctuation">,</span><span class="token user-variable">s</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">,</span><span class="token builtin">arrsize</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;$letters&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token user-variable">s</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">step</span><span class="token plain"> </span><span class="token user-variable">i</span><span class="token operator" style="color:#393A34">+=</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">*p</span><span class="token plain"> </span><span class="token user-variable">$letters</span><span class="token sign-punctuation">[</span><span class="token user-variable">i</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&quot;, &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="изменения-в-чтении-длинных-строк-разбитых-на-несколько">Изменения в чтении длинных строк, разбитых на несколько<a href="#изменения-в-чтении-длинных-строк-разбитых-на-несколько" class="hash-link" aria-label="Прямая ссылка на Изменения в чтении длинных строк, разбитых на несколько" title="Прямая ссылка на Изменения в чтении длинных строк, разбитых на несколько" translate="no">​</a></h3>
<p>Для того, чтобы разбивать длинные строки на несколько (для удобства чтения) в QSP используется сочетание символов <code>&quot; _&quot;</code> (пробел и символ нижнего подчёркивания). В плеерах версии 5.7.0 и ниже (кроме Quest Navigator 0.0.28) при разборе данной конструкции движок оставлял строки, как есть. Для примера возьмём такую конструкцию:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token user-variable">t</span><span class="token plain"> </span><span class="token user-variable">_</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token user-variable">_</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">t</span><span class="token sign-punctuation">:</span><br></span></code></pre></div></div>
<p>В плеерах версии 5.7.0 символы преформатирования будут исключены, при интерпретации, а строка, разбитая с помощью <code>&quot; _&quot;</code> будет объединена, как есть, то есть будет равнозначна строке:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token user-variable">tort</span><span class="token sign-punctuation">:</span><br></span></code></pre></div></div>
<p>В плеерах же версии 5.8.0 и выше данная строка будет объединена с добавлением пробела вместо каждого сочетания <code>&quot; _&quot;</code>, то есть будет равнозначна строке:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token user-variable">t</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token user-variable">t</span><span class="token sign-punctuation">:</span><br></span></code></pre></div></div>
<p>Данное отличие в прочтении строк используется, как костыль, чтобы отличить классический плеер версии 5.7.0 от Quest Navigator версии 0.0.28:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token user-variable">t</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">tort</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token user-variable">t</span><span class="token plain"> </span><span class="token user-variable">_</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token user-variable">_</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token user-variable">t</span><span class="token sign-punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Игра запущена на Quest Navigator&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Игра запущена на Классике&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="изменения-в-работе-функции-rand">Изменения в работе функции RAND<a href="#изменения-в-работе-функции-rand" class="hash-link" aria-label="Прямая ссылка на Изменения в работе функции RAND" title="Прямая ссылка на Изменения в работе функции RAND" translate="no">​</a></h3>
<p>В плеерах версии 5.7.0 и ниже второй параметр функции <code>RAND</code> по умолчанию был <code>0</code>. Например, если вы указывали число <code>100</code> в качестве аргумента функции <code>RAND</code>, то эта функция возвращала случайное чи сло от <code>0</code> до <code>100</code>. В плеерах версии 5.8.0 и выше, а так же в Quest Navigator, второй параметр по умолчанию равен <code>1</code>. То есть если вы укажете лишь одно число, например <code>100</code>, функция <code>RAND</code> вернёт случайное значение от <code>1</code> до <code>100</code>.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">100</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.7.0 вернёт значение от 0 до 100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">100</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.8.0 вернёт значение от 1 до 100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">10</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.7.0 вернёт значение от 0 до 10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">10</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.8.0 вернёт значение от 1 до 10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">5</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.7.0 вернёт значение от 0 до 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">5</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.8.0 вернёт значение от 1 до 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.7.0 вернёт значение 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.8.0 вернёт значение от 1 до 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.7.0 вернёт значение от 0 до 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">RAND</span><span class="token sign-punctuation">(</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! в 5.8.0 вернёт значение 1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="повышение-приоритета-функций-loc-и-obj">Повышение приоритета функций LOC и OBJ<a href="#повышение-приоритета-функций-loc-и-obj" class="hash-link" aria-label="Прямая ссылка на Повышение приоритета функций LOC и OBJ" title="Прямая ссылка на Повышение приоритета функций LOC и OBJ" translate="no">​</a></h3>
<p>В плеерах версии 5.7.0 (и ниже) у функций <code>LOC</code> и <code>OBJ</code> приоритет был ниже, чем у операций сравнения. Это могло быть неочевидным для выражений такого рода:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token sign-punctuation">(</span><span class="token builtin">obj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Отвёртка&#x27;</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">obj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Верёвка&#x27;</span><span class="token sign-punctuation">)</span><br></span></code></pre></div></div>
<p>Кажется, что данное выражение должно выполняться так: проверяется наличие предмета &quot;Отвёртка&quot;, проверяется наличие предмета &quot;Верёвка&quot;, и лишь потом значения сравниваются. Однако в 5.7.0 у операции сравнения приоритет выше, чем у <code>OBJ</code>. Поэтому сначала выполняется операция сранения, и лишь потом функция <code>OBJ</code>. Таким образом в плеерах версии 5.7.0 данное выражение всегда возвращает <code>0</code>.</p>
<p>В плеерах версии 5.8.0 (и выше) приоритет у функций <code>OBJ</code> и <code>LOC</code> выше, чем у операций сравнения, поэтому данное выражение будет вычисляться именно так, как мы предположили: сначала проверяется наличие обоих предметов и лишь потом сравниваются полученные значения. В плеерах 5.8.0 (и выше) данное выражение будет возвращать <code>1</code>, если оба предмета или отсутствуют, или присутствуют, и <code>0</code>, если одни предмет присутствует, а другой отсутствует.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="больше-аргументов-для-функций">Больше аргументов для функций<a href="#больше-аргументов-для-функций" class="hash-link" aria-label="Прямая ссылка на Больше аргументов для функций" title="Прямая ссылка на Больше аргументов для функций" translate="no">​</a></h3>
<p>В плеерах версии 5.7.0 (и ниже) максимальное число аргументов, которое вы могли передавать операторам и функциям, было <code>10</code>. Таким образом, например функции <code>MAX</code> и <code>MIN</code> могли производить поиск значений лишь среди десяти значений. В плеерах версии 5.8.0 и выше максимальное число аргументов, передаваемых функциям и операторам, — <code>20</code>.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! работает в плеерах любых версий</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">max</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;b&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;c&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;d&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;e&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;f&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;g&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;h&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;i&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;j&#x27;</span><span class="token sign-punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! работает лишь в плеерах версии 5.8.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">max</span><span class="token sign-punctuation">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;b&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;c&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;d&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;e&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;f&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;g&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;h&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;i&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;j&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;k&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;l&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;m&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;n&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;o&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;p&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;q&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;s&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;t&#x27;</span><span class="token sign-punctuation">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="старые-новости-о-которых-вы-могли-не-знать">Старые новости, о которых вы могли не знать<a href="#старые-новости-о-которых-вы-могли-не-знать" class="hash-link" aria-label="Прямая ссылка на Старые новости, о которых вы могли не знать" title="Прямая ссылка на Старые новости, о которых вы могли не знать" translate="no">​</a></h2>
<p>Здесь мы осветим пару изменений, которые появились в плеере версии 5.7.0 (или раньше), но которые прошли не очень заметно.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="игнорирование-отрицательных-индексов">Игнорирование отрицательных индексов<a href="#игнорирование-отрицательных-индексов" class="hash-link" aria-label="Прямая ссылка на Игнорирование отрицательных индексов" title="Прямая ссылка на Игнорирование отрицательных индексов" translate="no">​</a></h3>
<p>В плеерах версий ниже 5.6.5 отрицательные индексы приводились к нулю, а в плеерах более новых версий, они просто напросто игнорируются:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версии ниже 5.6.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! на экране увидим 123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! на экране увидим 456</span><br></span></code></pre></div></div>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версии 5.6.5 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! на экране увидим 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token user-variable">mass</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! на экране увидим 123</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="добавление-предмета-в-определённую-позицию">Добавление предмета в определённую позицию<a href="#добавление-предмета-в-определённую-позицию" class="hash-link" aria-label="Прямая ссылка на Добавление предмета в определённую позицию" title="Прямая ссылка на Добавление предмета в определённую позицию" translate="no">​</a></h3>
<p>Начиная с версии 5.6.5 вы можете добавлять предмет в указанную позицию в окне предметов. При этом, если на текущей позиции уже находится предмет, он сдвигается вниз (вправо) по списку, и все стоящие за ним предметы так же сдвигаются на одну позицию вниз (вправо).</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версии 5.6.5 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Отвёртка&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;путь к файлу картинки/картинка.png&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">4</span><br></span></code></pre></div></div>
<p>Индексация предметов в списке начинается с единицы. Можно указать индекс численно больший на один, чем число предметов, тогда предмет добавится в конец списка. Однако, если указать индекс числом больше числа предметов плюс один, или индекс меньше единицы, команда <code>addobj</code> будет проигнорирована:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версии 5.6.5 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Первый предмет&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Второй предмет&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Третий предмет&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Четвёртый предмет&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Пятый предмет&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! предмет будет добавлен в конец списка</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Седьмой предмет&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! предмет не будет добавлен</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">addobj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Нулевой предмет&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">! предмет не будет добавлен</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="копирование-части-массива-в-copyarr">Копирование части массива в COPYARR<a href="#копирование-части-массива-в-copyarr" class="hash-link" aria-label="Прямая ссылка на Копирование части массива в COPYARR" title="Прямая ссылка на Копирование части массива в COPYARR" translate="no">​</a></h3>
<p>Начиная с версии 5.7.0 вы можете копировать часть массива в дру гой массив, используя не обязательные параметры: начальный индекс и количество. В следующем примере в массив <code>&#x27;mass</code>&#x27; будут скопированы шесть элементов массива <code>&#x27;array</code>&#x27;, начиная с третьего:</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">! версии 5.7.0 и выше</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">copyarr</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mass&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;array&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">3</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">6</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="передача-аргументов-в-onnewloc">Передача аргументов в ONNEWLOC<a href="#передача-аргументов-в-onnewloc" class="hash-link" aria-label="Прямая ссылка на Передача аргументов в ONNEWLOC" title="Прямая ссылка на Передача аргументов в ONNEWLOC" translate="no">​</a></h3>
<p>Начиная с версии 5.7.0 аргументы, которые передаются на локацию при переходе на эту локацию с помощью операторов <code>GOTO</code> или <code>XGOTO</code>, передаются так же и на локацию-обработчик перехода на новую локацию (прописанную в переменной <code>$ONNEWLOC</code>). При этом, даже если значения в массиве <code>args</code> будут изменены на локации, на которую был осуществлён переход, на локацию, прописанную в переменной <code>$ONNEWLOC</code>, будут переданы исходные значения, переданные с <code>GOTO</code>/<code>XGOTO</code>.</p>
<div class="language-qsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-qsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token start-location"># start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">$onnewloc</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;onNewLoc&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;next&#x27;</span><span class="token sign-punctuation">,</span><span class="token string" style="color:#e3116c">&#x27;old text&#x27;</span><span class="token sign-punctuation">,</span><span class="token number" style="color:#36acaa">345</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># next</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;next:&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! значения, переданные с GOTO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! меняем значения на текущей локации</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">678</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;new text&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! изменённые значения</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--next</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token start-location"># onNewLoc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;onNewLoc:&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">! значения, переданные с GOTO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">$args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">0</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">*pl</span><span class="token plain"> </span><span class="token sys-variable">args</span><span class="token sign-punctuation">[</span><span class="token number" style="color:#36acaa">1</span><span class="token sign-punctuation">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token end-location">--onNewLoc</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="что-ещё">Что ещё?<a href="#что-ещё" class="hash-link" aria-label="Прямая ссылка на Что ещё?" title="Прямая ссылка на Что ещё?" translate="no">​</a></h2>
<p>Плеер продолжает развиваться и совершенствоваться, а значит мы можем ждать ещё много изменений в работе, которые непременно будут отражены в новых статьях, а так же в онлайн-справке <a href="https://wiki.qsp.org/" target="_blank" rel="noopener noreferrer" class="">wiki.qsp.org</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="post-scriptum">Post Scriptum<a href="#post-scriptum" class="hash-link" aria-label="Прямая ссылка на Post Scriptum" title="Прямая ссылка на Post Scriptum" translate="no">​</a></h2>
<p>Данную статью вы можете найти так же и на других ресурсах:</p>
<ul>
<li class=""><a href="http://aleksversus.narod.ru/index/novovvedenija_v_qsp_5_8_0/0-71" target="_blank" rel="noopener noreferrer" class="">мой_сайт/Что нового в QSP 5.8.0?</a></li>
<li class=""><a href="https://aleksversus.medium.com/%D0%BD%D0%BE%D0%B2%D0%BE%D0%B2%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B2-qsp-5-8-0-633e6eeb187e" target="_blank" rel="noopener noreferrer" class="">medium/Что нового в QSP 5.8.0?</a></li>
<li class=""><a href="https://vk.com/@qsplayer-novovvedeniya-v-qsp-580" target="_blank" rel="noopener noreferrer" class="">vk.com/Что нового в QSP 5.8.0?</a></li>
<li class=""><a href="https://ifhub.club/2021/06/11/novovvedeniya-v-qsp-580.html" target="_blank" rel="noopener noreferrer" class="">ifhub.club/Что нового в QSP 5.8.0?</a></li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href="/howdo_faq/docs/news/news_20240909_590"><div class="pagination-nav__sublabel">Предыдущая страница</div><div class="pagination-nav__label">Нововведения в QSP 5.9.0</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/howdo_faq/docs/news/news_20100613_570"><div class="pagination-nav__sublabel">Следующая страница</div><div class="pagination-nav__label">Обновление QSP (5.7.0) и QGen (4.0.0b)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#последние-нововведения" class="table-of-contents__link toc-highlight">Последние нововведения</a><ul><li><a href="#изменение-в-работе-массивов" class="table-of-contents__link toc-highlight">Изменение в работе массивов</a></li><li><a href="#многомерные-массивы" class="table-of-contents__link toc-highlight">Многомерные массивы</a></li><li><a href="#изменения-в-работе-логических-операторов-и-функций" class="table-of-contents__link toc-highlight">Изменения в работе логических операторов и функций</a></li><li><a href="#аргументы-передаваемые-с-операторами-goto-и-xgoto" class="table-of-contents__link toc-highlight">Аргументы, передаваемые с операторами GOTO и XGOTO</a></li><li><a href="#disablesubex-больше-нет" class="table-of-contents__link toc-highlight">DISABLESUBEX больше нет</a></li><li><a href="#изменения-в-работе-неявного-оператора" class="table-of-contents__link toc-highlight">Изменения в работе неявного оператора</a></li><li><a href="#неявный-вызов-пользовательских-функций" class="table-of-contents__link toc-highlight">Неявный вызов пользовательских функций</a></li><li><a href="#новая-функция-arritem" class="table-of-contents__link toc-highlight">Новая функция ARRITEM</a></li><li><a href="#killvar-удаляет-по-текстовому-индексу" class="table-of-contents__link toc-highlight">KILLVAR удаляет по текстовому индексу</a></li><li><a href="#операторы-addqst-и-killqst-переименованы" class="table-of-contents__link toc-highlight">Операторы ADDQST и KILLQST переименованы</a></li><li><a href="#изменение-в-работе-оператора-set" class="table-of-contents__link toc-highlight">Изменение в работе оператора SET</a></li><li><a href="#новый-оператор-local" class="table-of-contents__link toc-highlight">Новый оператор LOCAL</a></li><li><a href="#изменения-в-работе-функций-instr-arrcomp-arrpos" class="table-of-contents__link toc-highlight">Изменения в работе функций INSTR, ARRCOMP, ARRPOS</a></li><li><a href="#новый-оператор-цикла-loop" class="table-of-contents__link toc-highlight">Новый оператор цикла LOOP</a></li><li><a href="#изменения-в-чтении-длинных-строк-разбитых-на-несколько" class="table-of-contents__link toc-highlight">Изменения в чтении длинных строк, разбитых на несколько</a></li><li><a href="#изменения-в-работе-функции-rand" class="table-of-contents__link toc-highlight">Изменения в работе функции RAND</a></li><li><a href="#повышение-приоритета-функций-loc-и-obj" class="table-of-contents__link toc-highlight">Повышение приоритета функций LOC и OBJ</a></li><li><a href="#больше-аргументов-для-функций" class="table-of-contents__link toc-highlight">Больше аргументов для функций</a></li></ul></li><li><a href="#старые-новости-о-которых-вы-могли-не-знать" class="table-of-contents__link toc-highlight">Старые новости, о которых вы могли не знать</a><ul><li><a href="#игнорирование-отрицательных-индексов" class="table-of-contents__link toc-highlight">Игнорирование отрицательных индексов</a></li><li><a href="#добавление-предмета-в-определённую-позицию" class="table-of-contents__link toc-highlight">Добавление предмета в определённую позицию</a></li><li><a href="#копирование-части-массива-в-copyarr" class="table-of-contents__link toc-highlight">Копирование части массива в COPYARR</a></li><li><a href="#передача-аргументов-в-onnewloc" class="table-of-contents__link toc-highlight">Передача аргументов в ONNEWLOC</a></li></ul></li><li><a href="#что-ещё" class="table-of-contents__link toc-highlight">Что ещё?</a></li><li><a href="#post-scriptum" class="table-of-contents__link toc-highlight">Post Scriptum</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"><aside class="footerBlock">
<div class="eBlock">
<div class="avsPageStamp">
    <p class="emptyP">Aleks Versus'HowDo-F.A.Q'2019-2026. Built with Docusaurus.<br></p>
    <p class="emptyP">Aleks Versus'Game Adventure Making'Really Unimaginable Stories'2019-2026</p>
</div></div>
</aside></div></div></div></footer></div>
</body>
</html>