<folder path="D:\my\projects\howdo_faq\[source]\example">
<file path="D:\my\projects\howdo_faq\[source]\example\preobarzovanie_tipov.txt-light">
<head anchor="preobrazovanije_tipov_qsp" head-level="h1">
<p>
Преобразование типов в QSP</p>
</head>
<segment segment-class="for-head">
<segment segment-class="for-head">
<segment>
<p>
<tag name="simple-string">
Эта </tag>
<tag name="bold">
статья</tag>
<tag name="simple-string">
 поможет вам </tag>
<tag name="tt">
разобраться</tag>
<tag name="simple-string">
 в таком </tag>
<tag name="tt">
<tag name="hyperlink" href="#linetest">
<tag name="italic">
сложном вопросе</tag>
</tag>
</tag>
<tag name="simple-string">
, как преобразование типов в операции присвоения, или в выражениях.
</tag>
</p>
<p>
В QSP существует всего два типа значений: числовой и текстовый. Числовой означает любое целочисленное число в пределах от -2147483648 до 2147483647; а текстовый — любую строку текста (нет, на самом деле любую. Ограничения для строк — 2 Гб текста).
</p>
<p>
Вот как выглядят такие значения:
</p>
</segment>
<code code-left-level="4" code-type="qsp">
! числовые значения
<br/>123
<br/>345
<br/>999
<br/>
<br/>!текстовые значения
<br/>"строка текста"
<br/>'Ещё одна строка текста'
<br/>"Третья строка текста"
</code>
<segment>
<p>
Для хранения значений мы используем переменные или массивы. И точно так же массивы и переменные (далее просто — переменные) бывают двух типов.
</p>
<p>
Чтобы записать в числовую переменную числовое значение, мы просто пишем имя переменной, знак = и число:
</p>
</segment>
<code code-left-level="0" code-type="css">
/*
<br/>    данный стиль описывает внешний вид общего блока, играющего в т.ч. роль затенения
<br/>    (обратите внимание, на какую область в вашем шаблоне распространяется затенение)
<br/>*/
<br/>.modalDialog { 
<br/>    position: fixed; 
<br/>    top: 0;    right: 0;    bottom: 0; left: 0; 
<br/>    background: hsla(0,0%,0%,0.8); 
<br/>    z-index: 50; /* выводится одним из верхних слоёв */
<br/>    opacity: 0; /* видимость на нуле, чтобы игрок не видел содержимое */
<br/>    -webkit-transition: opacity 400ms ease-in; /* обеспечивает плавное появление */
<br/>    pointer-events: none; /* скрывает блок от курсора мыши */
<br/>} 
<br/>/* 
<br/>    псевдокласс :target применяется к тому элементу
<br/>    к которому обратился браузер/плеер по нажатию на ссылку (по id)
<br/>*/
<br/>.modalDialog:target { 
<br/>    opacity: 1; /* видимость повышается до 100% */
<br/>    pointer-events: auto; /* с блоком снова может работать мышь */
<br/>} 
<br/>/* стилизация дочернего блока, т.е. непосредственно окошка */
<br/>.modalDialog > div { 
<br/>    width: 400px; 
<br/>    position: relative; 
<br/>    margin: 10% auto; 
<br/>    padding: 5px 20px 13px 20px; 
<br/>    border-radius: 10px; 
<br/>    background: #fff; 
<br/>    background: -webkit-linear-gradient(#fff, #b8ecfb); 
<br/>}
</code>
<segment>
<p>
Чтобы записать в текстовую переменную текстовое значение, перед именем переменной мы обязательно ставим знак $.
</p>
</segment>
<code code-left-level="0" code-type="qsp">
# start
<br/>*pl "На следующей локации демонстрируется использование меню в качестве даилогового окна для выбора двух вариантов"
<br/>$dialog[]="Сообщение: кошелёк или жизнь:dial_loc:?"
<br/>$dialog[]="> Кошелёк:dial_loc"
<br/>$dialog[]="> Жизнь:dial_loc"
<br/>act "Перейти в следующую локацию":
<br/>    goto 'room'
<br/>end
<br/>-- start
<br/>
<br/># room
<br/>refint & ! данная функция принудительно обновит содержимое окон плеера при входе на локацию
<br/>:loop
<br/>menu '$dialog'
<br/>if variant<>1: jump 'loop'
<br/>-- room
<br/>
<br/># dial_loc
<br/>if args[0]=1:
<br/>    ! данный пункт меню не работает
<br/>elseif args[0]=2:
<br/>    *pl "Вы выбрали вариант кошелёк"
<br/>    variant=1
<br/>elseif args[0]=3:
<br/>    *pl "Вы выбради вариант жизнь"
<br/>    variant=1
<br/>end
<br/>-- dial_loc
</code>
<segment>
<p>
Если мы попытаемся записать в текстовую переменную числовое значение, плеер автоматически преобразует число в текст, и в текстовой переменной окажется текстовое значение:
</p>
</segment>
<code code-left-level="0" code-type="html">
<game title="Моя крутая Игра" resizeable="true" standalone="false" width=1280 height=720 />
<br/><link type="text/css" href="skins/game.css" rel="stylesheet" /><link type="text/css" href="avscss/coolstyle.css" rel="stylesheet" />
<br/><!-- <script type="text/javascript" src="../qsplib/js/core.js"></script>
<br/><script type="text/javascript" src="../qsplib/js/coreAwesomium.js"></script>
<br/><script type="text/javascript" src="../qsplib/js/QspLibAwesomium.js"></script> -->
<br/><script type="text/javascript" src="../qsplib/js/api.js"></script>
<br/><script type="text/javascript" src="../standalone_content/skins/js/game.js"></script>
</code>
<segment>
<p>
Если мы попытаемся присвоить числовой переменной текстовое значение, плеер попытается преобразовать текстовое значение в числовое, но если преобразование невозможно, на экране появится ошибка.
</p>
</segment>
<code code-left-level="4" code-type="qsp">
box='134'         & ! тип будет преобразован, а в box запишется число 134
<br/>cell='non cifer' & ! тип не будет преобразован, плеер выдаст ошибку 101
<br/>
<br/>! не эквивалентно
<br/>
<br/>box=val('134')          & ! строка преобразуется в число, в box запишется число 134
<br/>cell=val('non cifer') & ! строка не преобразуется в число, в cell запишется 0
<br/>
<br/>! только для команды 2 не удастся выполнить преобразование типа
</code>
<segment>
<p>
Всё становится гораздо интереснее, если мы имеем дело не с отдельными значениями, а с выражениями.
</p>
<p>
Например, если мы попытаемся сложить два числа, то результатом сложения будет третье число:
</p>
</segment>
<code code-left-level="4" code-type="qsp">
123+456 & ! результатом будет число 579
</code>
<segment>
<p>
Если мы попытаемся «сложить» две строки, то мы их просто «склеим» (в программировании это называется конкатенация):
</p>
</segment>
<code code-left-level="4" code-type="qsp">
"Hello"+"World" & ! результатом будет строка "HelloWorld"
</code>
<segment>
<p>
Но что будет, если мы попытаемся сложить число и строку?
</p>
<p>
А тут произойдёт вот что.
</p>
<p>
<tag name="simple-string">
Если хотя бы одно </tag>
<tag name="bold">
из значений</tag>
<tag name="simple-string">
 в выражении — </tag>
<tag name="tt">
числовое</tag>
<tag name="simple-string">
, плеер попытается все значения преобразовать в числовые и вычислить выражение:
</tag>
</p>
</segment>
<code code-left-level="4" code-type="qsp">
123+"456" & ! результатом будет число 579
</code>
<segment>
<p>
Если преобразование не удастся, то выполняется конкатенация:
</p>
</segment>
<code code-left-level="4" code-type="qsp">
123+"d456" & ! результатом будет строка 123d456
</code>
<segment>
<p>
Строки можно только «складывать» или сравнивать, поэтому если вы попытаетесь проделать с ними какие-то другие штуки, плеер выдаст ошибку о несоответствии типов данных:
</p>
</segment>
<code code-left-level="4" code-type="qsp">
"Hello"-"World" & ! плеер выдаст ошибку 101
</code>
<segment>
<p>
Однако, если возможно преобразование всех строк в числа, то можно сделать так:
</p>
</segment>
<code code-left-level="4" code-type="qsp">
"4560"/"3"*"9" & ! результатом будет число 13680
</code>
<segment>
<p>
Таким образом, плеер обязательно преобразует тип к необходимому, если это возможно, особенно для операций присвоения.
</p>
<p>
Вам не нужно строго следить за тем, какие типы значений вы используете в выражениях, однако старайтесь избегать выражений, в которых математические операции применяются к строкам.
</p>
<p>
Старайтесь не использовать строковые и числовые значения в одном выражении, либо приводите их к требуемому типу с помощью функций $str и val:
</p>
</segment>
<code code-left-level="4" code-type="qsp">
$str(1234) & ! преобразует число в строку
<br/>! если получает строку, возвращает строку
<br/>$str("string")
<br/>
<br/>val("1234") & ! преобразует строку в число
<br/>! если не может преобразовать в число, возвращает ноль
<br/>val("string")
</code>
<segment>
<p>
Не забывайте пользоваться подвыражениями, если нужно вставить значение в строку:
</p>
</segment>
<code code-left-level="4" code-type="qsp">
health=100
<br/>max_health=350
<br/>*pl "Здоровье: <<health>>/<<max_health>>."
</code>
</segment>
<head anchor="post_scriptum_articles_0001" head-level="h4">
<p>
P.S.:</p>
</head>
<segment segment-class="for-head">
<segment>
<p>
Данную статью вы можете найти так же и на других ресурсах:
</p>
</segment>
<list list-type="ul-list">
<segment name="li">
<p>
<tag name="hyperlink" href="http://aleksversus.narod.ru/index/preobrazovanie_tipov_v_qsp/0-53">
мой_сайт/преобразование_типов_в_QSP</tag>
</p>
</segment>
<segment name="li">
<p>
<tag name="hyperlink" href="https://aleksversus.medium.com/преобразование-типов-в-qsp-8eec585f93e2">
medium/Преобразование типов в QSP</tag>
</p>
</segment>
<segment name="li">
<p>
<tag name="hyperlink" href="https://vk.com/@qsplayer-preobrazovanie-tipov-v-qsp">
vk.com/Преобразование типов в QSP</tag>
</p>
</segment>
<segment name="li">
<p>
<tag name="hyperlink" href="https://ifhub.club/2020/09/23/preobrazovanie-tipov-v-qsp.html">
ifhub.club/Преобразование типов в QSP</tag>
</p>
</segment>
</list>
</segment>
</segment>
</file>
</folder>
