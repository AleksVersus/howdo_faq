<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <link id="favicon" rel="icon" type="image/x-icon" href="../res/favicon.ico" />
    <link type="text/css" rel="stylesheet" href="../res/css/easy.library.css" />
    <title>QSP: Как сделать?</title>
</head>
    
<body>
    <div class="avs-page-wrapper">
        <div class="easy-lib-page">
            <h1 class="avs-article-h1">Онлайн-справочник по самым часто задаваемым вопросам из темы "<a href="https://qsp.org/index.php?option=com_agora&task=topic&id=40&Itemid=57">Как сделать?</a>" на форуме <a href="https://qsp.org/index.php?option=com_agora&Itemid=57" title="перейти на форум" target="_blank">QSP.su</a></h1>
            <!-- body start -->
<div class="avs-pages-button__wrapper"><div class="avs-pages-button__left-combine"><div class="avs-pages-button"><a href="https://aleksversus.github.io/howdo_faq/pages/xor_0070.html" class="avs-pages-button__link">&lt; Назад, к странице 71</a></div></div><div class="avs-pages-button__right-combine"><div class="avs-pages-button"><a href="https://aleksversus.github.io/howdo_faq/pages/sluchajnoe_nazvanie_peremennoj_0072.html" class="avs-pages-button__link">Вперёд, к странице 73 &gt;</a></div></div></div>
<h3 id="faq_12_01" class="avs-article-h3">12.1. Зачем нужен оператор `dynamic`?</h3><p>
В: Зачем нужен оператор `dynamic`?
</p>
<p>
О:
</p>
<p>
Оператор `dynamic` предназначен для выполнения кода, записанного в виде текста.
</p>
<p>
Например, у нас есть код:
</p>
<div class="Monokai-Code">
<span class="Monokai-Koperator">if</span>&nbsp;яблоко<span class="Monokai-Operator">=</span><span class="Monokai-Numeric">1</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">*</span><span class="Monokai-Operator">pl</span>&nbsp;<span class="Monokai-String">"У&nbsp;меня&nbsp;одно&nbsp;яблоко."</span><br/>
<span class="Monokai-Koperator">elseif</span>&nbsp;яблоко<span class="Monokai-Operator">&gt;</span><span class="Monokai-Numeric">1</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">*</span><span class="Monokai-Operator">pl</span>&nbsp;<span class="Monokai-String">"У&nbsp;меня&nbsp;есть&nbsp;несколько&nbsp;яблок."</span><br/>
<span class="Monokai-Koperator">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">*</span><span class="Monokai-Operator">pl</span>&nbsp;<span class="Monokai-String">"У&nbsp;меня&nbsp;нет&nbsp;яблок."</span><br/>
<span class="Monokai-Koperator">end</span><br/>
</div>
<p>
Мы можем записать этот код в текстовом виде и передать оператору `dynamic` в качестве аргумента. Оператор `dynamic` выполнит код, записанный в виде текста, как обычный код:
</p>
<div class="Monokai-Code">
<span class="Monokai-Operator">dynamic</span>&nbsp;<span class="Monokai-String">'if&nbsp;яблоко=1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;одно&nbsp;яблоко."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;яблоко&gt;1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;есть&nbsp;несколько&nbsp;яблок."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;нет&nbsp;яблок."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end'</span><br/>
</div>
<p>
Это удобно, если нам нужно поместить кусочек кода в переменную, а затем вызывать в нужных местах:
</p>
<div class="Monokai-Code">
$code<span class="Monokai-Operator">=</span><span class="Monokai-String">'if&nbsp;яблоко=1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;одно&nbsp;яблоко."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;яблоко&gt;1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;есть&nbsp;несколько&nbsp;яблок."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;нет&nbsp;яблок."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end'</span><br/>
<br/>
<span class="Monokai-Operator">dynamic</span>&nbsp;$code<br/>
</div>
<p>
Например, этот способ подходит, когда нужно поместить большой объём кода в гиперссылку:
</p>
<div class="Monokai-Code">
<span class="Monokai-Operator">*</span><span class="Monokai-Operator">pl</span>&nbsp;<span class="Monokai-String">"Кажется&nbsp;в&nbsp;моём&nbsp;рюкзаке&nbsp;были&nbsp;&lt;a&nbsp;href='exec:dynamic&nbsp;$code'&gt;яблоки&lt;/a&gt;."</span><br/>
</div>
<p>
Так же, поскольку `dynamic` выполняет код, записанный в виде текста, можно генерировать код на лету:
</p>
<div class="Monokai-Code">
<span class="Monokai-Operator"></span><span class="Monokai-Comment">!&nbsp;получаем&nbsp;набор&nbsp;значений&nbsp;(может&nbsp;быть&nbsp;сформирован&nbsp;задолго&nbsp;до&nbsp;прихода&nbsp;на&nbsp;локацию&nbsp;с&nbsp;dynamic)</span><br/>
яблоко<span class="Monokai-Operator">=</span><span class="Monokai-Numeric">10</span><br/>
груша<span class="Monokai-Operator">=</span><span class="Monokai-Numeric">5</span><br/>
<span class="Monokai-Koperator">if</span>&nbsp;$var_word<span class="Monokai-Operator">=</span><span class="Monokai-String">""</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;$var_word<span class="Monokai-Operator">=</span><span class="Monokai-String">'яблоко'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;$text_word<span class="Monokai-Operator">=</span><span class="Monokai-String">'яблок'</span><br/>
<span class="Monokai-Koperator">end</span><span class="Monokai-Operator"><br/>
<br/>
</span><span class="Monokai-Comment">!&nbsp;действия,&nbsp;переключающие&nbsp;значения:</span><br/>
<span class="Monokai-Koperator">act</span>&nbsp;<span class="Monokai-String">"Сколько&nbsp;у&nbsp;меня&nbsp;яблок"</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;$var_word<span class="Monokai-Operator">=</span><span class="Monokai-String">'яблоко'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;$text_word<span class="Monokai-Operator">=</span><span class="Monokai-String">'яблок'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">goto</span>&nbsp;<span class="Monokai-Func">$curloc</span><br/>
<span class="Monokai-Koperator">end</span><br/>
<span class="Monokai-Koperator">act</span>&nbsp;<span class="Monokai-String">"Сколько&nbsp;у&nbsp;меня&nbsp;груш"</span><span class="Monokai-Operator">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;$var_word<span class="Monokai-Operator">=</span><span class="Monokai-String">'груша'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;$text_word<span class="Monokai-Operator">=</span><span class="Monokai-String">'груш'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="Monokai-Operator">goto</span>&nbsp;<span class="Monokai-Func">$curloc</span><br/>
<span class="Monokai-Koperator">end</span><span class="Monokai-Operator"><br/>
</span><span class="Monokai-Comment">!&nbsp;генерируем&nbsp;код,&nbsp;основываясь&nbsp;на&nbsp;значении&nbsp;заданных&nbsp;переменных</span><br/>
$code<span class="Monokai-Operator">=</span><span class="Monokai-String">'if&nbsp;&lt;&lt;$var_word&gt;&gt;=1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;одно&nbsp;&lt;&lt;$var_word&gt;&gt;."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;(&lt;&lt;$var_word&gt;&gt;)&gt;1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;есть&nbsp;несколько&nbsp;&lt;&lt;$text_word&gt;&gt;."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;нет&nbsp;&lt;&lt;$text_word&gt;&gt;."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end'</span><span class="Monokai-Operator"><br/>
</span><span class="Monokai-Comment">!&nbsp;выполняем&nbsp;сгенерированный&nbsp;код</span><br/>
<span class="Monokai-Operator">dynamic</span>&nbsp;code<br/>
</div>
<p>
Работает это так. После того как в переменные забиты изначальные значения, будет выполнен код, выводящий действия, и команда, которая присвоит переменной `$code` некое текстовое значение. В текстовом значении присутствуют вложенные выражения (двойные угловые скобки). Плеер раскроет вложенные выражения, т.е. вместо них подставит значения тех выражений, которые вписаны в двойные угловые скобки. Это либо значение переменной `$var_word` либо переменной `$text_word`. Таким образом при первом посещении в переменную `$code` будет вписан текст:
</p>
<div class="Monokai-Code">
$code<span class="Monokai-Operator">=</span><span class="Monokai-String">'if&nbsp;яблоко=1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;одно&nbsp;яблоко."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;яблоко&gt;1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;есть&nbsp;несколько&nbsp;яблок."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;нет&nbsp;яблок."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end'</span><br/>
</div>
<p>
Далее `dynamic` просто выполнит получившийся код, записанный в переменную `$code`.
</p>
<p>
Когда мы нажмём на действие "Сколько у меня груш", в переменные `$var_word` и `$text_word` впишутся соответственно значения "груша" и "груш", затем плеер перезайдёт на текущую локацию (команда `goto $curloc`), снова выведет на экран оба действия, и выполнит команду, которая присваивает переменной `$code` значение. Плееру вновь потребуется раскрыть вложенные выражения, и он снова подставит значения переменных `$var_word` и `$text_word` вместо соответствующих подвыражений, таким образом переменной `$code` снова присвоится готовый текст:
</p>
<div class="Monokai-Code">
$code<span class="Monokai-Operator">=</span><span class="Monokai-String">'if&nbsp;груша=1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;одно&nbsp;груша."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;груша&gt;1:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;есть&nbsp;несколько&nbsp;груш."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*pl&nbsp;"У&nbsp;меня&nbsp;нет&nbsp;груш."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end'</span><br/>
</div>
<p>
Далее `dynamic` просто выполнит получившийся код, записанный в переменную `$code`.
</p>
<div class="avs-pages-button__wrapper"><div class="avs-pages-button__left-combine"><div class="avs-pages-button"><a href="https://aleksversus.github.io/howdo_faq/pages/xor_0070.html" class="avs-pages-button__link">&lt; Назад, к странице 71</a></div></div><div class="avs-pages-button__right-combine"><div class="avs-pages-button"><a href="https://aleksversus.github.io/howdo_faq/pages/sluchajnoe_nazvanie_peremennoj_0072.html" class="avs-pages-button__link">Вперёд, к странице 73 &gt;</a></div></div></div>
<!-- body end -->
            </article>
            <aside class="e-block">
                <div class="avs-page-stamp">
                    <p class="empty">Aleks Versus'HowDo-F.A.Q.'2021-<span class="subscribe-year">2022</span></p>
                    <p class="empty">Aleks Versus'Game Adventure Making'Really Unimaginable Stories'2013-<span class="subscribe-year">2022</span></p>
                </div>
            </aside>
            <aside class="em-btn">
                <div class="avs-pages-button__wrapper e-block">
                    <div class="avs-pages-button">
                        <a href="https://aleksversus.github.io/howdo_faq/" class="avs-pages-button__link">Главная</a>
                    </div>
                    <div class="avs-pages-button">
                        <a href="#"  class="avs-pages-button__link" id="section-content-open">Содержание</a>
                    </div>
                </div>
            </aside>
        </div><!-- easy-lib-page -->
    </div><!-- avs-page-wrapper -->
    <aside id="soderzhanije_outer">
        <div class="soderzhanije">
<header-header></header-header>
        </div>
    </aside>
    <script type="text/javascript" src="../res/js/text_replace.js"></script>
    <script type="text/javascript" src="../res/js/soderzhanie.js" ></script>
</body>
</html>
